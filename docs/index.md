# Hello World

â›…ï¸â™¥ï¸ğŸŒ€ğŸ’ªğŸ’¦ğŸ§ğŸ™‡ğŸš£ğŸ”ğŸ¯ğŸªâ–¼ğŸ‘‡â—âœï¸ğŸ“ğŸš€ğŸ”¥âš ï¸ğŸŒğŸš¨ğŸ™ŒğŸ›¡ï¸ğŸŒŸğŸ†ğŸ§©ğŸ›¡ï¸ğŸ””â±ï¸ğŸ—ƒï¸âš›ï¸ğŸ“£ğŸ¤ğŸ—ï¸ ğŸ§­ğŸªœ â­•ï¸ğŸ”šğŸ’¬ğŸ”œğŸ“ŒğŸ‘‘ â“âœ¨âŒğŸ¥‡ğŸ¥ˆğŸ¥‰ğŸ› ğŸ“Šâš™ï¸ ğŸ§ªğŸ§ ğŸ”§âœ”âœ…ğŸš«ğŸ”ğŸ§­ ğŸ§±
ğŸ’¥

ä»¥ä¸‹ã«ã€äººäº‹æƒ…å ±å—ä¿¡å‡¦ç†ã®æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã‚’é›†ç´„ãƒ»æ•´ç†ã—ã¾ã—ãŸã€‚ä¸»è¦ãªå‡¦ç†ã‚¹ãƒ†ãƒƒãƒ—ã¨æ³¨æ„ç‚¹ã‚’æ˜ç¢ºã«ç¤ºã—ã¦ã„ã¾ã™ã€‚

### äººäº‹æƒ…å ±å—ä¿¡å‡¦ç† æ¥­å‹™ãƒ•ãƒ­ãƒ¼æ¦‚è¦

#### 1. äº‹å‰æº–å‚™

- **å¿…é ˆãƒ•ã‚¡ã‚¤ãƒ«**ï¼š6 ç¨®é¡ã® CSVï¼ˆçµ„ç¹”/åº—éƒ¨èª²/ç¤¾å“¡/AD æƒ…å ±/æ©Ÿæ§‹æ”¹é©/çµ‚äº†ãƒ•ãƒ©ã‚°ï¼‰
- **é‹ç”¨å´ä½œæ¥­**ï¼š
  - é™¤å¤–å½¹è·æƒ…å ±ç™»éŒ²ï¼ˆ`exclude_executive`ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
  - ãƒ€ãƒŸãƒ¼æƒ…å ±æ•´å‚™ï¼ˆ`DUM_ORGANIZATION`/`DUM_DEPARTMENT`/`DUM_EMPLOYEE`ï¼‰
  - é–¾å€¤è¨­å®šï¼ˆ`THRESHOLD`ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

#### 2. å‡¦ç†ãƒ•ãƒ­ãƒ¼

1. **ãƒ•ã‚¡ã‚¤ãƒ«å—ä¿¡ãƒã‚§ãƒƒã‚¯**

   - æ—©æœ 6 æ™‚ã« Hulft è»¢é€ã‚’ç¢ºèª
   - å¿…é ˆ 6 ãƒ•ã‚¡ã‚¤ãƒ«æ¬ ææ™‚ã¯å³æ™‚ã‚¨ãƒ©ãƒ¼

2. **ãƒ­ãƒƒã‚¯å‡¦ç†**

   - äºŒé‡å®Ÿè¡Œé˜²æ­¢ã®ãŸã‚ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

3. **ãƒ‡ãƒ¼ã‚¿å–è¾¼ï¼ˆå…¨ä»¶ç½®æ›ï¼‰**
   | CSV ãƒ•ã‚¡ã‚¤ãƒ« | å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ« | ç‰¹åˆ¥å‡¦ç†å†…å®¹ |
   |---------------------|---------------------|------------------------------------------------------------------------------|
   | organization.csv | BIZ_ORGANIZATION | ãƒ€ãƒŸãƒ¼çµ„ç¹”é™¤å¤– |
   | department.csv | BIZ_DEPARTMENT | ä¼šç¤¾ã‚³ãƒ¼ãƒ‰ 001/002 ä»¥å¤–é™¤å¤– + ãƒ€ãƒŸãƒ¼åº—éƒ¨èª²é™¤å¤– |
   | employee.csv | BIZ_EMPLOYEE | ä¼šç¤¾ã‚³ãƒ¼ãƒ‰åˆ¶é™ + ãƒ€ãƒŸãƒ¼ç¤¾å“¡ + é™¤å¤–å½¹è·ã‚³ãƒ¼ãƒ‰é™¤å¤– |
   | ad.csv | BIZ_AD | ãƒ­ã‚°ã‚ªãƒ³å 10 æ¡æ™‚ã¯æœ«å°¾ 7 æ¡ä½¿ç”¨ï¼ˆé‡è¤‡æ™‚ã¯å¾Œå‹ã¡ï¼‰ |
   | shift.csv | BIZ_SHIFT | å­˜åœ¨æ™‚ã®ã¿å–è¾¼ |
   | EOFAD/EOFAM | - | å‡¦ç†çµ‚äº†ãƒ•ãƒ©ã‚° |

4. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§å‡¦ç†**

   - **é–¾å€¤ãƒã‚§ãƒƒã‚¯**ï¼šå…¥ç¤¾æ•° + é€€ç¤¾æ•° + ç•°å‹•æ•°ãŒé–¾å€¤è¶…éæ™‚ã¯ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
   - **åº—éƒ¨èª²ãƒã‚¹ã‚¿åŒæœŸ**ï¼š
     - æ–°è¦åº—éƒ¨èª²è¿½åŠ ï¼ˆ`M_SECTION`ï¼‰
     - æ—¢å­˜åº—éƒ¨èª²æƒ…å ±æ›´æ–°ï¼ˆåç§°/è¦ª ID/çµ„ç¹”ã‚³ãƒ¼ãƒ‰/è¡¨ç¤ºé †ï¼‰
   - **ç¤¾å“¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†**ï¼š
     - é€€ç¤¾å‡¦ç†ï¼ˆ4 ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‰Šé™¤ãƒ•ãƒ©ã‚°æ›´æ–°ï¼‰
     - å…¥ç¤¾å‡¦ç†ï¼ˆ`APP_USER`ã¸ã®æ–°è¦ç™»éŒ²ï¼‰
     - ç¤¾å“¡æƒ…å ±æ›´æ–°ï¼ˆç¤¾å“¡åŒºåˆ†/æ°å/ç”Ÿå¹´æœˆæ—¥ãªã©ï¼‰

5. **çµ„ç¹”å¤‰æ›´å¯¾å¿œ**
   - **æ‹ ç‚¹çµ±å»ƒåˆ**ï¼š
     1. å»ƒæ­¢åº—éƒ¨èª²ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼/é›»è©±æ©Ÿã‚’æ–°éƒ¨ç½²ã«ç§»è¡Œ
     2. é–¢é€£ãƒªã‚½ãƒ¼ã‚¹æ›´æ–°ï¼ˆCallingSearchSpace/PickupGroup/èª²é‡‘å…ˆï¼‰
   - **æ‰€å±ç®¡ç†**ï¼š
     - æ–°è¦æ‰€å±è¿½åŠ ï¼ˆå…¥ç¤¾/è»¢å‹¤/å…¼å‹™å¯¾å¿œï¼‰
     - æ‰€å±å¤‰æ›´ï¼ˆåº—éƒ¨èª²åå¤‰æ›´æ™‚ï¼‰
     - è»¢å‡ºå…ƒæ‰€å±å‰Šé™¤ï¼ˆé›»è©±æ©Ÿæœªç´ä»˜æ™‚ã¯ç‰©ç†å‰Šé™¤ï¼‰

#### 3. çµ‚äº†å‡¦ç†

- **æ­£å¸¸æ™‚**ï¼š
  - CSV ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªãƒãƒ¼ãƒ ï¼ˆ`_IMPORTED_YYYYMMDDHH24MISS`ï¼‰
  - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒŸãƒƒãƒˆ
  - ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
- **ç•°å¸¸æ™‚**ï¼š
  - å…¨å‡¦ç†ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆå‰æ—¥çŠ¶æ…‹ã«å¾©æ—§ï¼‰
  - ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›

#### 4. å‡ºåŠ›ç‰©

- **é€€è·è€…ä¸€è¦§**ï¼š`retired_users_YYYY-MM-DD.log`
  ```sql
  SELECT å§“, å, é›»è©±ç•ªå·, å§“åçµåˆID
  FROM APP_USER
  WHERE DELETED = '1'
  ORDER BY é›»è©±ç•ªå·
  ```

### ç‰¹åˆ¥æ³¨æ„ç‚¹

1. **å…¨ä»¶ç½®æ›æ–¹å¼**ï¼š

   - æ¯å›ãƒ†ãƒ¼ãƒ–ãƒ«å…¨å‰Šé™¤ â†’ å†ç™»éŒ²ã®ãŸã‚ã€CSV ã¯å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå¿…è¦
   - ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿é™¤å¤–ã¯å–è¾¼å¾Œã«å®Ÿæ–½

2. **ã‚¨ãƒ©ãƒ¼å‡¦ç†**ï¼š

   - CSV å½¢å¼ä¸æ­£ã‚„é–¾å€¤è¶…éæ™‚ã¯å³æ™‚ä¸­æ­¢
   - ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã«ã‚ˆã‚‹ç•°å¸¸æ¤œçŸ¥

3. **æ‰‹å‹•å®Ÿè¡Œ**ï¼š

   - å®šæœŸãƒãƒƒãƒï¼ˆæ—¥æ¬¡ï¼‰ä»¥å¤–ã«ã‚·ã‚§ãƒ«èµ·å‹•ã§éšæ™‚å®Ÿè¡Œå¯èƒ½

4. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**ï¼š
   - å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿å¯¾å¿œã®ãŸã‚ã€é–¾å€¤ç®¡ç†ã‚’å®Ÿæ–½
   - ãƒãƒƒãƒå‡¦ç†æ™‚é–“å¸¯ã‚’è€ƒæ…®ï¼ˆé€šå¸¸ã¯æ·±å¤œå¸¯å®Ÿè¡Œï¼‰

> ã“ã®å‡¦ç†ã¯äººäº‹ã‚·ã‚¹ãƒ†ãƒ ã¨çµ±åˆ ID ã‚·ã‚¹ãƒ†ãƒ ã®é‡è¦ãªé€£æºãƒã‚¤ãƒ³ãƒˆã§ã‚ã‚Šã€çµ„ç¹”å¤‰æ›´ã‚„äººäº‹ç•°å‹•ãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸Šã§æ­£ã—ãåæ˜ ã•ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚ç‰¹ã«æ©Ÿæ§‹æ”¹é©æ™‚ã®æ‹ ç‚¹çµ±å»ƒåˆå‡¦ç†ã§ã¯ã€é›»è©±æ©Ÿã‚„èª²é‡‘æƒ…å ±ãªã©è¤‡æ•°ã®é–¢é€£ãƒªã‚½ãƒ¼ã‚¹ãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã‚‹ã“ã¨ãŒç‰¹å¾´ã§ã™ã€‚

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.exception

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.exception/AlreadyExecutedException.java`

```java
/*
 * LockFileManager.java
 *
 * <pre>
 * ãƒãƒƒãƒã®å¤šé‡èµ·å‹•ã‚’é˜²ããƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã®æ“ä½œã‚’è¡Œã†ã‚¯ãƒ©ã‚¹
 * <MODIFICATION HISTORY>
 * 1.0 2013/09/12 KSC Hiroaki Endo
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
package jp.co.ksc.batch.exception;

/**
 * <pre>
 * ãƒãƒƒãƒå‡¦ç†ã‚’2é‡èµ·å‹•ã—ãŸå ´åˆã«å ±å‘Šã•ã‚Œã‚‹ä¾‹å¤–ã§ã™ã€‚
 * <MODIFICATION HISTORY>
 * 1.0 2013/09/12 KSC Hiroaki Endo
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public class AlreadyExecutedException extends Exception {

    /**
     * AlreadyExecutedException ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
     */
    public AlreadyExecutedException() {
        super();
    }

    /**
     * è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿æŒã™ã‚‹ AlreadyExecutedException ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
     *
     * @param message è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     */
    public AlreadyExecutedException(String message) {
        super(message);
    }

    /**
     * åŸå› ã¨ãªã£ãŸä¾‹å¤–ã‚’ä¿æŒã™ã‚‹ AlreadyExecutedException ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
     *
     * @param cause åŸå› ã¨ãªã£ãŸä¾‹å¤–
     */
    public AlreadyExecutedException(Throwable cause) {
        super(cause);
    }

    /**
     * è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨åŸå› ã¨ãªã£ãŸä¾‹å¤–ã‚’ä¿æŒã™ã‚‹ AlreadyExecutedException ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
     *
     * @param message è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     * @param cause   åŸå› ã¨ãªã£ãŸä¾‹å¤–
     */
    public AlreadyExecutedException(String message, Throwable cause) {
        super(message, cause);
    }
}
```

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.exception/BatRuntimeException.java`

```java
/*
 * BatRuntimeException.java
 *
 * @date 2013/09/12
 * @version 1.0
 * author KSC Hiroaki Endo
 */

package jp.co.ksc.batch.exception;

import java.io.PrintStream;
import java.io.PrintWriter;

/**
 * ãƒãƒƒãƒç³»ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ç™ºç”Ÿã—ãŸã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã‚’å ±å‘Šã™ã‚‹ãŸã‚ã®ä¾‹å¤–ã‚¯ãƒ©ã‚¹
 *
 * <MODIFICATION HISTORY>
 * 1.0 2013/09/12 KSC Hiroaki Endo
 *
 * author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public class BatRuntimeException extends RuntimeException {
    /** å…ƒã®ä¾‹å¤– */
    private Throwable th;

    /**
     * BatRuntimeException ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
     */
    public BatRuntimeException() {
        super();
    }

    /**
     * è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿æŒã™ã‚‹ BatRuntimeException ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
     * @param message è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     */
    public BatRuntimeException(final String message) {
        super(message);
    }

    /**
     * åŸå› ã¨ãªã£ãŸä¾‹å¤–ã‚’ä¿æŒã™ã‚‹ BatRuntimeException ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
     * @param cause åŸå› ã¨ãªã£ãŸä¾‹å¤–
     */
    public BatRuntimeException(final Throwable cause) {
        th = cause;
    }

    /**
     * è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨åŸå› ã¨ãªã£ãŸä¾‹å¤–ã‚’ä¿æŒã™ã‚‹ BatRuntimeException ã®
     * ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
     * @param message è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     * @param cause åŸå› ã¨ãªã£ãŸä¾‹å¤–
     */
    public BatRuntimeException(final String message, final Throwable cause) {
        super(message);
        th = cause;
    }

    /**
     * @see java.lang.Throwable#printStackTrace()
     */
    public void printStackTrace() {
        super.printStackTrace();
        System.err.println("*** Root Cause >>>");
        if (th != null) {
            th.printStackTrace();
        }
    }

    /**
     * @see java.lang.Throwable#printStackTrace(java.io.PrintStream)
     */
    public void printStackTrace(PrintStream s) {
        super.printStackTrace(s);
        s.println("*** Root Cause >>>");
        if (th != null) {
            th.printStackTrace(s);
        }
    }
}
```

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.exception/CSVException.java`

```java
/**
 * Copyright (c) 2014, NET MARKS COMPANY, LIMITED All Rights Reserved.
 *
 * CSVException.java
 *
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */

package jp.co.ksc.batch.exception;

import java.io.PrintStream;
import java.io.PrintWriter;

/**
 * csvãƒ•ã‚¡ã‚¤ãƒ«ã«ç•°å¸¸ãŒã‚ã£ãŸå ´åˆã«å ±å‘Šã•ã‚Œã‚‹ä¾‹å¤–ã‚¯ãƒ©ã‚¹ã€‚
 *
 * <pre>
 * &lt;MODIFICATION HISTORY&gt;
 * 1.0 2013/09/12 KSC Hiroaki Endo FX
 * </pre>
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public class CSVException extends Exception {

    /** å…ƒã®ä¾‹å¤– */
    private Throwable th;

    /**
     * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
     */
    public CSVException() {
        super();
    }

    /**
     * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
     * @param message è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     */
    public CSVException(String message) {
        super(message);
    }

    /**
     * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
     * @param cause åŸå› ã¨ãªã£ãŸä¾‹å¤–
     */
    public CSVException(Throwable cause) {
        th = cause;
    }

    /**
     * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
     * @param message è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     * @param cause åŸå› ã¨ãªã£ãŸä¾‹å¤–
     */
    public CSVException(String message, Throwable cause) {
        super(message);
        th = cause;
    }

    /**
     * @see java.lang.Throwable#printStackTrace()
     */
    public void printStackTrace() {
        super.printStackTrace();
        System.err.println("*** Root Cause >>> ");
        if (th != null) {
            th.printStackTrace();
        }
    }

    /**
     * @see java.lang.Throwable#printStackTrace(java.io.PrintStream)
     */
    public void printStackTrace(PrintStream s) {
        super.printStackTrace(s);
        s.println("*** Root Cause >>> ");
        if (th != null) {
            th.printStackTrace(s);
        }
    }

    /**
     * @see java.lang.Throwable#printStackTrace(java.io.PrintWriter)
     */
    public void printStackTrace(PrintWriter s) {
        super.printStackTrace(s);
        s.println("*** Root Cause >>> ");
        if (th != null) {
            th.printStackTrace(s);
        }
    }
}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.log4j

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.log4j/BatchJobErrorFileAppender.java`

```java
/*
 * Copyright (c) 2014, NET MARKS COMPANY, LIMITED All Rights Reserved.
 *
 * BatchJobErrorFileAppender.java
 *
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */
package jp.co.ksc.batch.log4j;

import java.sql.Timestamp;
import java.text.SimpleDateFormat;

import org.apache.log4j.FileAppender;


/**
 * <pre>
 * BatchJobAppender
 *
 * &lt;MODIFICATION HISTORY&gt;
 * 1.0 2013/09/12 KSC Hiroaki Endo æ–°è¦ä½œæˆ
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public class BatchJobErrorFileAppender extends FileAppender {

	/* (é Javadoc)
	 * @see org.apache.log4j.FileAppender#setFile(java.lang.String)
	 */
	public void setFile(String fileName) {

		/* ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•° */
		String[] commands = System.getProperty("sun.java.command").split(" ");
		String jobName = commands[2];

		/* èµ·å‹•æ—¥æ™‚ */
		String timestamp = new SimpleDateFormat("yyyy-MM-dd_HH-mm-ss").format(new Timestamp(System.currentTimeMillis()));

		super.setFile(fileName + jobName + "_ERROR_" + timestamp + ".log");
	}
}
```

`irdb/jp.co.ksc.batch.log4j/BatchJobFileAppender.java`

```java
/*
 * Copyright (c) 2014, NET MARKS COMPANY, LIMITED All Rights Reserved.
 *
 * BatchJobFileAppender.java
 *
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */
package jp.co.ksc.batch.log4j;

import java.sql.Timestamp;
import java.text.SimpleDateFormat;

import org.apache.log4j.FileAppender;


/**
 * <pre>
 * BatchJobAppender
 *
 * &lt;MODIFICATION HISTORY&gt;
 * 1.0 2013/09/12 KSC Hiroaki Endo æ–°è¦ä½œæˆ
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public class BatchJobFileAppender extends FileAppender {

	/* (é Javadoc)
	 * @see org.apache.log4j.FileAppender#setFile(java.lang.String)
	 */
	public void setFile(String fileName) {

		/* ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•° */
		String[] commands = System.getProperty("sun.java.command").split(" ");
		String jobName = commands[2];

		/* èµ·å‹•æ—¥æ™‚ */
		String timestamp = new SimpleDateFormat("yyyy-MM-dd_HH-mm-ss").format(new Timestamp(System.currentTimeMillis()));

		super.setFile(fileName + jobName + "_" + timestamp + ".log");
	}
}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.step.processor

`irdb/jp.co.ksc.batch.step.processor/MasterProcessor.java`

```java
/**
 * MasterProcessor.javal
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */
package jp.co.ksc.batch.step.processor;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.batch.item.ItemProcessor;

/**
 * ãƒã‚¹ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—Processor (å‡¦ç†ãªã—)
 * author ksc
 **/
public class MasterProcessor implements ItemProcessor<Object, Object> {
    @SuppressWarnings("unused")
    private static final Log log = LogFactory.getLog(MasterProcessor.class);

    /**
     * (é Javadoc)
     * @see org.springframework.batch.item.ItemProcessor#process(Object)
     */
    @Override
    public Object process(Object param) throws Exception {
        return param;
    }
}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.step.reader

`irdb/jp.co.ksc.batch.step.reader/MasterReader.java`

```java
/*
 * Copyright (c) 2014, NET MARKS COMPANY, LIMITED All Rights Reserved
 *
 * MasterReader.java
 *
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */
package jp.co.ksc.batch.step.reader;

import java.util.ArrayList;
import java.util.List;

import org.springframework.batch.item.ItemReader;
import org.springframework.batch.item.NonTransientResourceException;
import org.springframework.batch.item.ParseException;
import org.springframework.batch.item.UnexpectedInputException;

/**
 * MasterReader
 *
 * <pre>
 * ãƒã‚¹ã‚¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾— JOBReader (å‡¦ç†ãªã—)
 *
 * &lt;MODIFICATION HISTORY&gt;
 * 1.0 2013/09/12 KSC Hiroaki Endo
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public class MasterReader implements ItemReader<Object> {
    // å®Ÿè¡Œãƒ•ãƒ©ã‚°
    private boolean flag = true;

    /**
     * (é Javadoc)
     *
     * @see org.springframework.batch.item.ItemReader#read()
     */
    public Object read() throws Exception, UnexpectedInputException, ParseException, NonTransientResourceException {
        List<Integer> tmpList = new ArrayList<Integer>();
        tmpList.add(0);
        if (flag) {
            flag = false;
            return tmpList;
        } else {
            return null;
        }
    }
}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.step.writer

`irdb/jp.co.ksc.batch.step.writer/LoadStaffInfoWriter.java`

```java
package jp.co.ksc.batch.step.writer;

import java.io.IOException;
import java.util.List;
import java.util.Properties;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.batch.item.ItemWriter;
import org.springframework.beans.factory.annotation.Autowired;

import jp.co.ksc.batch.exception.BatRuntimeException;
import jp.co.ksc.batch.util.BatchSettings;
import jp.co.ksc.batch.util.LockFileManager;
import jp.co.netmarks.batch.component.LoadStaffInfoLogic;
import jp.co.netmarks.batch.dao.StaffInfoDAO;
import jp.co.netmarks.batch.dao.VacuumDAO;
import jp.co.netmarks.batch.persistence.LoadStaffMapper;
import jp.co.netmarks.util.ErrorMail;

/**
 * <p>Title: LoadStaffInfoWriter.java</p>
 * <pre>
 * äººäº‹æƒ…å ±å–è¾¼ Job Writer
 * </pre>
 * 2023/06/21
 * author Yao Kaikyou
 */
public class LoadStaffInfoWriter implements ItemWriter<Object> {
    private static final Log log = LogFactory.getLog(LoadStaffInfoWriter.class);

    @Autowired
    private Properties properties;

    @Autowired
    private LoadStaffInfoLogic lsl;

    @Autowired
    private StaffInfoDAO lsdao;

    @Autowired
    private LoadStaffMapper lsMapper;

    @Autowired
    private VacuumDAO vd;

    @Autowired
    private ErrorMail errMail;

    /**
     * äººäº‹æƒ…å ±å–è¾¼å‡¦ç†ãƒ¡ã‚¤ãƒ³
     *
     * @param paramList ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼
     * @throws Exception
     */
    public void write(List<?> paramList) throws Exception {
        BatchSettings bs = new BatchSettings(properties);

        // ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
        try {
            LockFileManager.lock(bs);
            log.info(bs.getProperty("BT_000_1001"));
            // 1s1.movFiles(bs); // ãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹•ã¯ç¢ºèªæ¸ˆã¿ãªã®ã§ã€ä¸€æ—¦ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
        } catch (IOException ex) {
            String errorMessage = bs.getProperty("BT_000_E001");
            throw new BatRuntimeException(errorMessage, ex);
        } finally {
            // ãƒ­ãƒƒã‚¯è§£é™¤
            LockFileManager.unlock(bs);
        }

        try {
            String impcsvPath = bs.getCsvFtpDir(); // inputDir å¤‰æ•°A
            String InpCompPath = bs.getInputCompDir(); // å¤‰æ•°B
            // String OupRetirePath = bs.getOutputRetireDir(); // é€€è·ãƒ»åŠ å…¥è€…ãƒ‡ãƒ¼ã‚¿æ ¼ç´å…ˆ å¤‰æ•°C
            String fileEoFAd = bs.getEofAd(); // EofAd å¤‰æ•°D
            System.out.println(fileEoFAd);
            String fileEoFAM = bs.getEofAm(); // EofAm å¤‰æ•°E
            System.out.println(fileEoFAM);
            String bizAdFileNM = bs.getTmpAdCsvFileName(); // BizAdã®CSVãƒ•ã‚¡ã‚¤ãƒ«å å¤‰æ•°F
            System.out.println(bizAdFileNM);
            String bizDeptFileNM = bs.getTmpIntDepartmentCsvFileName(); // BizDepartmentã®CSVãƒ•ã‚¡ã‚¤ãƒ«å å¤‰æ•°G
            System.out.println(bizDeptFileNM);
            String bizEmpFileNM = bs.getTmpIntEmployeeCsvFileName(); // BizEmployeeã®csvãƒ•ã‚¡ã‚¤ãƒ«å å¤‰æ•°H
            System.out.println(bizEmpFileNM);
            String bizorgFileNM = bs.getTmpIntOrganizationCsvFileName(); // BizOrganizationã®CSVãƒ•ã‚¡ã‚¤ãƒ«å å¤‰æ•°I
            System.out.println(bizorgFileNM);
            // String rUserFileNM = bs.getRetiredUserFileName(); // é€€è·è€…æƒ…å ±ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«å å¤‰æ•°J
            // String jUserFileNM = bs.getJoinedUserFileName(); // åŠ å…¥è€…æƒ…å ±ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«å å¤‰æ•°K
            // String receivePath = bs.getReceiveDir(); // ReceiveDir å¤‰æ•°L
            System.out.println(impcsvPath);
            String[] fileNames = {
                    // impcsvPath + fileEoFAD,
                    // impcsvPath + fileEoFAM,
                    impcsvPath + bizAdFileNM,
                    impcsvPath + bizDeptFileNM,
                    impcsvPath + bizEmpFileNM,
                    impcsvPath + bizorgFileNM
            };
            if (!lsl.existsIndispensableCsvFile(fileNames)) {
                log.warn("äººäº‹æƒ…å ±å–è¾¼ã¿å¯¾è±¡ç„¡ã—");
                throw new BatRuntimeException();
            } else {
                // å–å¾—å‰ã«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¯ãƒªã‚¢
                // BIZ_ADå–è¾¼
                lsMapper.deleteBizAD();
                lsl.doBizAd(bs);

                // BIZ_DEPARTMENTå–è¾¼
                lsMapper.deleteBizDepartment();
                lsl.doBizDepartment(bs); // å¾Œã‚ã®å‡¦ç†ã«ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ãªã®ã§ã€ä»®ã«ã€Œdao.deleteBizDepartment();ã€ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ

                // BIZ_EMPLOYEEå–è¾¼
                lsMapper.deleteBizEmployee();
                lsl.doBizEmployee(bs);

                // BIZ_ORGANIZATIONå–è¾¼
                lsMapper.deleteBizOrganization();
                // lsl.doBizorganization(bs);
                lsl.doBizOrganization(bs);
            }

            int msectioncnt = 0;
            int cntEmployee = 0;
            // åº—éƒ¨èª²ãƒã‚¹ã‚¿è¿½åŠ 
            msectioncnt = lsdao.insertMSection();
            log.info("åº—éƒ¨èª²è¿½åŠ ä»¶æ•° : " + msectioncnt);

            msectioncnt = lsdao.updateMSection();
            log.info("åº—éƒ¨èª²æƒ…å ±æ›´æ–°ä»¶æ•° : " + msectioncnt);

            // é€€ç¤¾å‡¦ç†
            cntEmployee = lsdao.retireAppUser();
            log.info("é€€ç¤¾äººæ•° : " + cntEmployee);

            String oPPath = bs.getOutPutNewUsersDir();
            System.out.println("OPPath---------" + oPPath);
            String JoinedPath = bs.getJoinedUserFileName();
            System.out.println("JoinedPath---" + JoinedPath);

            // å…¥ç¤¾å‡¦ç†
            cntEmployee = lsdao.additionAppUser();
            log.info("å…¥ç¤¾äººæ•°: " + cntEmployee);

            // æ—¢å­˜ç¤¾å“¡ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ›´æ–°
            cntEmployee = lsdao.updateAppUser();
            log.info("ç¤¾å“¡æƒ…å ±æ›´æ–°ä»¶æ•° : " + cntEmployee);

            // ç¤¾å“¡ã®æ‰€å±è¿½åŠ 
            cntEmployee = lsdao.additionRUserSection();
            log.info("ç¤¾å“¡æ‰€å±è¿½åŠ ä»¶æ•° : " + cntEmployee);

            // ç¤¾å“¡ã®æ‰€å±å¤‰æ›´
            cntEmployee = lsdao.updateRUserSetion();
            log.info("ç¤¾å“¡æ‰€å±æ›´æ–°ä»¶æ•° : " + cntEmployee);

            // ç¤¾å“¡ã®è»¢å‡ºå…ƒæ‰€å±å‰Šé™¤
            cntEmployee = lsdao.changePersonnel();
            log.info("ç¤¾å“¡æ‰€å±å‰Šé™¤ä»¶æ•° : " + cntEmployee);

            // FileRename
            lsl.csvFileRename(bs);

            // é€€ç¤¾è€…ãƒªã‚¹ãƒˆå‡ºåŠ›
            lsl.retiredUserFileOut(bs);

            // ä¾‹å¤–å‡¦ç† ã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
            lsl.creaErrFile(bs);

            log.info("Vacuum Analyzeé–‹å§‹");
            vd.dayVacuum();
            log.info("Vacuum Analyzeçµ‚äº†");
        } catch (Exception e) {
            throw e;
        } finally {
            // ãƒ­ãƒƒã‚¯è§£é™¤
            LockFileManager.unlock(bs);
        }
    }
}
```

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.step.writer/CUCCSVExport.java`

```java
/*
 * Copyright (c) 2014, NET MARKS COMPANY, LIMITED All Rights Reserved.
 *
 * CUCCSVExport.java
 *
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */
package jp.co.ksc.batch.step.writer;

import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.text.MessageFormat;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.List;
import java.util.Map;
import java.util.Properties;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.batch.item.ItemWriter;
import org.springframework.beans.factory.annotation.Autowired;

import jp.co.ksc.batch.exception.BatRuntimeException;
import jp.co.ksc.batch.exception.CSVException;
import jp.co.ksc.batch.util.BatchSettings;
import jp.co.ksc.batch.util.CSVWriter;
import jp.co.ksc.batch.util.LockFileManager;
import jp.co.netmarks.batch.persistence.CSVExpImpMapper;

/**
 * <p>Title: CUCCSVExport.java</p>
  * <pre>
  * 'csvå›ºå®šå€¤æ›¸ãè¾¼ã¿å¯¾å¿œ
  * </pre>
* @Time:2023/07/14
* @author Yao KaiKyou
 */
public class CUCCSVExport implements ItemWriter<Object> {

    private static final Log log = LogFactory.getLog(CUCCSVExport.class);

    @Autowired
    private Properties properties;
    @Autowired
    private CSVExpImpMapper csvMapper;

    /**
     * Unityã‚’CSVã¸Exportã—ã¾ã™
     * @param paramList ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
     * @throws Exception
     */
    @Override
    public void write(List<?> paramList) throws Exception {

        BatchSettings bs = new BatchSettings(properties);
        // ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
        try {
            LockFileManager.lock(bs);
        } catch (IOException ex) {
            throw new BatRuntimeException(ex.getMessage(), ex);
        }
        try {

            // ãƒ‡ãƒ¼ã‚¿å–å¾—
            Map<String,Object>[] expVL = csvMapper.getCUCExp();
            log.info("expVLã®è¦ç´ æ•°: " + expVL.length);

            String[] header = bs.getCUCCsvHeader().split(",", 0);
            if (header != null) {
                String outputFile = bs.getOutputDirAssociate() + getExpTimeAddFileNM(bs.getExportCUC());
                CSVWriter.writeCSV(outputFile, String.join(",", header), expVL);
            } else {
                String logMessage = bs.getProperty("BT_000_E003");
                String replacedMessage = MessageFormat.format(logMessage, "CUCCsvHeader");
                log.warn(replacedMessage);
                throw new CSVException();
            }

            //String logMessage = bs.getProperty("BT_000_E003");
            String logMessage = "{0}ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ã¯æ­£å¸¸çµ‚äº†ã—ã¾ã—ãŸã€‚å‡¦ç†ä»¶æ•°ï¼š{1}";
            String arg1 = getExpTimeAddFileNM(bs.getExportCUC());
            int arg2 = expVL.length;
            logMessage = MessageFormat.format(logMessage, arg1, arg2);
            log.info(logMessage);
        } catch (Exception e) {
            throw e;
        } finally {
            // ãƒ­ãƒƒã‚¯è§£é™¤
            LockFileManager.unlock(bs);
        }
    }

    /**
     * ãƒ•ã‚¡ã‚¤ãƒ«åã®æ‹¡å¼µå­ã®å‰ã«ç¾åœ¨ã®æ™‚é–“ã‚’è¿½åŠ ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
     * @param fileName ãƒ•ã‚¡ã‚¤ãƒ«å
     * @return æ‹¡å¼µå­ã®å‰ã«ç¾åœ¨ã®æ™‚é–“ã‚’è¿½åŠ ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«å
     */
    private String getExpTimeAddFileNM(String fileName) {
        String timestamp = LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyyMMdd_HHmmss"));
        int dotIndex = fileName.lastIndexOf(".");
        if (dotIndex != -1) {
            // æ‹¡å¼µå­ãŒå­˜åœ¨ã™ã‚‹å ´åˆ
            String name = fileName.substring(0, dotIndex);
            String extension = fileName.substring(dotIndex);
            return name + "_" + timestamp + extension;
        } else {
            // æ‹¡å¼µå­ãŒå­˜åœ¨ã—ãªã„å ´åˆ
            return fileName + "_" + timestamp;
        }
    }

    /**
     * CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚€ãƒ¡ã‚½ãƒƒãƒ‰
     * @param fileName ãƒ•ã‚¡ã‚¤ãƒ«å
     * @param header ãƒ˜ãƒƒãƒ€ãƒ¼
     * @param data ãƒ‡ãƒ¼ã‚¿
     * @throws IOException
     */
    private void writeCSV(String fileName, String header, Map<String,Object>[] data) throws IOException {
        try (BufferedWriter writer = new BufferedWriter(new FileWriter(fileName))) {
            // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ›¸ãè¾¼ã‚€
            writer.write(header);
            writer.newLine();

            // ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚€
            for (Map<String,Object> row : data) {
                StringBuilder sb = new StringBuilder();
                for (Object value : row.values()) {
                    String sanitizedValue = sanitizeValue(value != null ? value.toString() : "");
                    sb.append(sanitizedValue).append(",");
                }
                sb.deleteCharAt(sb.lastIndexOf(","));
                writer.write(sb.toString());
                writer.newLine();
            }
        } catch (IOException e) {
            throw new IOException("CSVãƒ•ã‚¡ã‚¤ãƒ«ã®æ›¸ãè¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " + e.getMessage(), e);
        }
    }

    /**
     * å€¤ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
     * @param value ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹å€¤
     * @return ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚ŒãŸå€¤
     */
    private String sanitizeValue(String value) {
        // "?"ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å‡¦ç†ã™ã‚‹
        if (value.contains("?")) {
            value = value.replace("?", "\\?");
        }
        return value;
    }
}
```

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.step.writer/LineListCSVExport.java`

```java
/*
 * Copyright (c) 2014, NET MARKS COMPANY, LIMITED All Rights Reserved.
 *
 * LineListCSVExport.java
 *
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */
package jp.co.ksc.batch.step.writer;

import java.io.File;
import java.io.IOException;
import java.util.List;
import java.util.Map;
import java.util.Properties;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.batch.item.ItemWriter;
import org.springframework.beans.factory.annotation.Autowired;

import jp.co.ksc.batch.exception.BatRuntimeException;
import jp.co.ksc.batch.exception.CSVException;
import jp.co.ksc.batch.util.BaseConstants;
import jp.co.ksc.batch.util.BatchSettings;
import jp.co.ksc.batch.util.CSVUtil;
import jp.co.ksc.batch.util.LockFileManager;
import jp.co.netmarks.batch.persistence.CSVExpImpMapper;

/**
 * <pre>
 * LineListCSVExportor
 *
 * &lt;MODIFICATION HISTORY&gt;
 * 1.0 2013/09/12 KSC Hiroaki Endo æ–°è¦ä½œæˆ
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public class LineListCSVExport implements ItemWriter<Object> {

	private static final Log log = LogFactory.getLog(LineListCSVExport.class);

	@Autowired
    private Properties properties;
	@Autowired
	private CSVExpImpMapper csvMapper;

	/**
	 * LineListã‚’CSVã¸Exportã—ã¾ã™
	 * @param paramList ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
	 * @throws Exception
	 */
	@Override
	public void write(List<?> paramList) throws Exception {

		BatchSettings bs = new BatchSettings(properties);
        // ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
        try {
            LockFileManager.lock(bs);
        } catch (IOException ex) {
            throw new BatRuntimeException(ex.getMessage(), ex);
        }
        try {

            // ãƒ‡ãƒ¼ã‚¿å–å¾—
        	BaseConstants constants = new BaseConstants();
            //Map<String,Object>[] expVL = csvMapper.getLineListExp(constants);
            Map<String,Object>[] expVL = csvMapper.getUserAndTelCsvList(constants);
         // ãƒ«ãƒ¼ãƒ—å‡¦ç†ã§expVLã®ä¸­èº«ã‚’ãƒ­ã‚°ã«å‡ºåŠ›ã™ã‚‹
            for (Map<String, Object> map : expVL) {
                for (Map.Entry<String, Object> entry : map.entrySet()) {
                    String key = entry.getKey();
                    Object value = entry.getValue();

                    // ãƒ­ã‚°ã«å‡ºåŠ›
                    log.info(key + ": " + value);
                    // ã¾ãŸã¯ã€System.out.printã§å‡ºåŠ›ã™ã‚‹å ´åˆ
                    // System.out.print(key + ": " + value + " ");
                }
                // æ”¹è¡Œã‚’å…¥ã‚Œã‚‹ãŸã‚ã®ãƒ­ã‚°å‡ºåŠ›
                log.info(""); // ã¾ãŸã¯ System.out.println(""); ã‚’ä½¿ã†å ´åˆ
            }


            // å‡ºåŠ›
            CSVUtil csv = new CSVUtil(expVL);
            csv.setHasHeader(true);
	        String[] header = bs.getLineListCsvHeader().split(",",0);

	        if (header != null) {
	            for (int i = 0; i < header.length; i++) {
	            	csv.addHeader(header[i]);
	            }
	        } else {
	            log.warn("CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãŒå®šç¾©ã•ã‚Œã¦ã¾ã›ã‚“ã€‚");
	            throw new CSVException();
	        }
            csv.setFileName(bs.getOutputDirCircuitlist() + csv.getExpTimeAddFileNM(bs.getExportLineList()));

            File backupDir = new File(bs.getOutputDirCircuitlist());
            if (!backupDir.exists()) {
                backupDir.mkdirs();
            }
            csv.write();

		}catch (Exception e){
			throw e;
		} finally {
            // ãƒ­ãƒƒã‚¯è§£é™¤
            LockFileManager.unlock(bs);
		}
	}
}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.util

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.util/LoadStaffInfoWriter.java`

```java
package jp.co.ksc.batch.util;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.StandardCopyOption;
import java.util.ArrayList;
import java.util.List;

import org.springframework.batch.item.ItemWriter;

/**
 * <p>Title: LoadStaffInfoWriter.java</p>
  * <pre>
  * é€£æºãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»å‹•ç”¨ã‚¯ãƒ©ã‚¹
  * </pre>
* @Time:2023/07/04
* @author Yao KaiKyou
 */
public class LoadStaffInfoWriter implements ItemWriter<Object> {
    private String importDir;
    private String exportDir;

    public LoadStaffInfoWriter(String importDir, String exportDir) {
        this.importDir = importDir;
        this.exportDir = exportDir;
    }

    public void write(List<?> plist) throws Exception {
        List<String> fileList = listFilesInDirectory(importDir);
        for (String fileName : fileList) {
            copyAndDeleteFile(importDir, exportDir, fileName);
        }
    }

    private List<String> listFilesInDirectory(String directory) {
        List<String> fileList = new ArrayList<>();
        File folder = new File(directory);
        if (folder.exists() && folder.isDirectory()) {
            File[] files = folder.listFiles();
            if (files != null) {
                for (File file : files) {
                    if (file.isFile()) {
                        fileList.add(file.getName());
                    }
                }
            }
        }
        return fileList;
    }

    private void copyAndDeleteFile(String sourceDir, String targetDir, String fileName) throws IOException {
        Path sourcePath = new File(sourceDir, fileName).toPath();
        Path targetPath = new File(targetDir, fileName).toPath();

        Files.copy(sourcePath, targetPath, StandardCopyOption.REPLACE_EXISTING);
        Files.delete(sourcePath);
    }
}
```

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.util/LockFileManager.java`

```java
package jp.co.ksc.batch.util;

import java.io.File;
import java.io.IOException;
import jp.co.ksc.batch.exception.AlreadyExecutedException;

/**
 * LockFileManager.java
 *
 * <pre>
 * ãƒãƒƒãƒã®å¤šé‡èµ·å‹•ã‚’é˜²ããƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã®æ“ä½œã‚’è¡Œã†ã‚¯ãƒ©ã‚¹
 * <MODIFICATION HISTORY>
 * 1.0 2013/09/12 KSC Hiroaki Endo
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public final class LockFileManager {

    /**
     * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
     */
    private LockFileManager() {
        super();
    }

    /**
     * ãƒ­ãƒƒã‚¯ã‚’ã‹ã‘ã¾ã™ã€‚
     *
     * @param setting BatchSettings
     * @throws AlreadyExecutedException ã™ã§ã«ãƒ­ãƒƒã‚¯ãŒã‹ã‹ã£ã¦ã„ãŸå ´åˆã«å ±å‘Šã•ã‚Œã¾ã™ã€‚
     * @throws IOException              ãƒ•ã‚¡ã‚¤ãƒ«å…¥å‡ºåŠ›ã‚¨ãƒ©ãƒ¼
     */
    public static synchronized void lock(BatchSettings setting)
            throws AlreadyExecutedException, IOException {
        File lock = new File(setting.getLockFile());
        if (lock.isFile()) {
            throw new AlreadyExecutedException("ã™ã§ã«ãƒãƒƒãƒãŒèµ·å‹•ã—ã¦ã„ã¾ã™ã€‚");
        } else {
            if (!lock.getParentFile().isDirectory()) {
                lock.getParentFile().mkdirs();
            }
            lock.createNewFile();
        }
    }

    /**
     * ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã—ã¾ã™ã€‚
     *
     * @param setting BatchSettings
     */
    public static synchronized void unlock(BatchSettings setting) {
        File lock = new File(setting.getLockFile());
        if (lock.isFile()) {
            lock.delete();
        }
    }

    /**
     * ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
     *
     * @param setting BatchSettings
     * @return true ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ã€‚false: ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã›ã‚“
     */
    public static boolean isLocked(BatchSettings setting) {
        File lock = new File(setting.getLockFile());
        return lock.isFile();
    }
}
```

`ãƒãƒƒãƒå‡¦ç†/batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.ksc.batch.util/BatchSettings.java`

```java
/*
 * Copyright (c) 2014, NET MARKS COMPANY, LIMITED All Rights Reserved.
 *
 * BatchSettings.java
 *
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */
package jp.co.ksc.batch.util;

import java.io.Serializable;
import java.util.Properties;

import org.springframework.beans.factory.annotation.Autowired;

import jp.co.ksc.batch.exception.BatRuntimeException;

/**
 * <pre>
 * ãƒãƒƒãƒã®æŒ™å‹•ã«é–¢ã™ã‚‹è¨­å®šã‚’ä¿æŒã™ã‚‹ã‚¯ãƒ©ã‚¹
 *
 * &lt;MODIFICATION HISTORY&gt;
 * 1.0 2013/09/12 KSC Hiroaki Endo æ–°è¦ä½œæˆ
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public class BatchSettings implements Serializable {

	@Autowired
    private Properties props;
	private String osType = "Win32";

    /**
     * ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
     * @param p ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹
     */
    public BatchSettings(Properties p) {
        super();
    	this.props = p;
    	String osname = System.getProperty("os.name");
    	if(osname.indexOf("Windows")>=0){
    	   // Windowsã§ã‚ã£ãŸã¨ãã®å‡¦ç†
    		this.osType = "Win32";
    	} else if(osname.indexOf("Linux")>=0){
    	   // Linuxã§ã‚ã£ãŸã¨ãã®å‡¦ç†
    		this.osType = "Linux";
    	}
    }

    /**
     * ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
     */
    public BatchSettings() {
        super();
    }

    /**
     * ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹å®šKEYæƒ…å ±ã‚’å–å¾—
     * @param key
     * @return ç‰¹å®šKEYã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æƒ…å ±
     */
    public String getProperty(String key){
        return props.getProperty(key);
    }

    /**
     * ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
     */
    public String getLockFile() {
        String value = props.getProperty("LockFile."+ osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« LockFile ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * CSVInputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return FTPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getInputDir() {
        String value = props.getProperty("InputDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«InputDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * CSVFTPå…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return FTPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getCsvFtpDir() {
        return getInputDir();
    }

    /**
     * CSVImportCompleteãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return FTPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getInputCompDir() {
        String value = props.getProperty("InputCompDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«InputDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ReceiveDirãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return ReceiveDirãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getReceiveDir() {
        String value = props.getProperty("ReceiveDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«ReceiveDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }


    /**
     * Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getOutputDir() {
        String value = props.getProperty("OutputDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«OutputDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * DBCSV Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getOutputDirDB() {
        String value = props.getProperty("OutputDir."+osType);
        value += props.getProperty("OutputDir2."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«OutputDir2ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * AssociateCSV Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getOutputDirAssociate() {
        String value = props.getProperty("OutputDir."+osType);
        value += props.getProperty("OutputDir3."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«OutputDir3ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * CircuitlistCSV Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getOutputDirCircuitlist() {
        String value = props.getProperty("OutputDir."+osType);
        value += props.getProperty("OutputDir4."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«OutputDir4ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * RetireCSV Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getReceiveStDir() {
        String value = props.getProperty("ReceiveDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«ReceiveStDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

   /**
     * RetireCSV Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getOutPutRetireDir() {
        String value = props.getProperty("OutputRetireDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«OutputRetireDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * NewUsersCSV Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return Outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getOutPutNewUsersDir() {
        String value = props.getProperty("OutputNewUsersDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«OutputNewUsersDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ãƒãƒƒãƒã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return ãƒãƒƒãƒã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getOutPutErrFileDir() {
        String value = props.getProperty("ErrorFile."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«OutPutErrFileDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ãƒãƒƒãƒã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«åã®å–å¾—
     * @return ãƒãƒƒãƒã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getOutPutErrFileNm() {
        String value = props.getProperty("ErrorFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«OutPutErrFileNmã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ãƒãƒƒãƒã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ã—ãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å–å¾—
     * @return ãƒãƒƒãƒã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ã—ãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     */
    public String getErrMessage() {
        String value = props.getProperty("BT_000_E007");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«ErrMessageã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨é›»è©±æ©Ÿã®ä¸€è¦§ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return FTPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getManageSearchCsvDir() {
        String value = props.getProperty("ManageSearchCsvDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«ManageSearchCsvDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿
     */
    public String getFileSeparetor(){
        return System.getProperty("file.separator");
    }

    /**
     * BizOrganizaionã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getBizOrganizationCsvFileName() {
        String value = props.getProperty("BizOrganizationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizOrganizationCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizDepartmentã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getBizDepartmentCsvFileName() {
        String value = props.getProperty("BizDepartmentCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizDepartmentCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizEmployeeã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getBizEmployeeCsvFileName() {
        String value = props.getProperty("BizEmployeeCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizEmployeeCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizAdã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getBizAdCsvFileName() {
        String value = props.getProperty("BizAdCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizAdCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * TmpIntEmployeeã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getTmpIntEmployeeCsvFileName() {
        String value = props.getProperty("TmpIntEmployeeCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« TmpIntEmployeeCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * TmpIntDepartmentã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getTmpIntDepartmentCsvFileName() {
        String value = props.getProperty("TmpIntDepartmentCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« TmpIntDepartmentCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * TmpAdã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getTmpAdCsvFileName() {
        String value = props.getProperty("TmpAdCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« TmpAdCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * BizShiftã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getBizShiftCsvFileName() {
        String value = props.getProperty("BizShiftCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizShiftCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * DumOrganizationã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDumOrganizationCsvFileName() {
        String value = props.getProperty("DumOrganizationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« DumOrganizationCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * TmpOrganizationã®csvãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     *
     * @return csvãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getTmpIntOrganizationCsvFileName() {
        String value = props.getProperty("TmpIntOrganizationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«TmpOrganizationCsvFileNameã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * DumDepartmentã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDumDepartmentCsvFileName() {
        String value = props.getProperty("DumDepartmentCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« DumDepartmentCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * DumEmployeeã®CSVãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
     * @return CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDumEmployeeCsvFileName() {
        String value = props.getProperty("DumEmployeeCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« DumEmployeeCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

////////////////////////////////////////////////////////////////////////////////////////////////////
//  ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨CSVãƒ•ã‚¡ã‚¤ãƒ« -----------------------------------------------------
    /**
     * APP_USER ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return APP_USER ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbAppUserCsvFileName() {
        String value = props.getProperty("DbAppUserCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbAppUserCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BIZ_AD ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return BIZ_AD ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbBizAdFileName() {
        String value = props.getProperty("DbBizAdFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbBizAdFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BIZ_DEPARTMENT ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return BIZ_DEPARTMENT ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbBizDepartmentCsvFileName() {
        String value = props.getProperty("DbBizDepartmentCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbBizDepartmentCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BIZ_EMPLOYEE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return BIZ_EMPLOYEE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbBizEmployeeCsvFileName() {
        String value = props.getProperty("DbBizEmployeeCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbBizEmployeeCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BIZ_ORGANIZATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return BIZ_ORGANIZATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbBizOrganizationCsvFileName() {
        String value = props.getProperty("DbBizOrganizationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbBizOrganizationCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BIZ_SHIFT ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return BIZ_SHIFT ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbBizShiftCsvFileName() {
        String value = props.getProperty("DbBizShiftCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbBizShiftCsvFileName  ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * CCM_LINE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return CCM_LINE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbCcmLineCsvFileName() {
        String value = props.getProperty("DbCcmLineCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbCcmLineCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }

        return value;
    }
    /**
     * CHARGE_ASSOCIATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å–ã‚Šè¾¼ã¿ç”¨)
     * @return CHARGE_ASSOCIATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbChargeAssociationCsvFileName() {
        String value = props.getProperty("DbChargeAssociationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbChargeAssociationCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * DUM_DEPARTMENT ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return DUM_DEPARTMENT ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbDumDepartmentCsvFileName() {
        String value = props.getProperty("DbDumDepartmentCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbDumDepartmentCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * DUM_EMPLOYEE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return DUM_EMPLOYEE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbDumEmployeeCsvFileName() {
        String value = props.getProperty("DbDumEmployeeCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbDumEmployeeCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * DUM_ORGANIZATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return DUM_ORGANIZATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbDumOrganizationCsvFileName() {
        String value = props.getProperty("DbDumOrganizationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbDumOrganizationCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * M_BRANCH ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return M_BRANCH ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbMBranchCsvFileName() {
        String value = props.getProperty("DbMBranchCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbMBranchCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * M_SECTION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return M_SECTION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbMSectionCsvFileName() {
        String value = props.getProperty("DbMSectionCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbMSectionCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

 /**
     * R_CCM_PHONE_LINE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return R_CCM_PHONE_LINE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbRCcmPhoneLineCsvFileName() {
        String value = props.getProperty("DbRCcmPhoneLineCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbRCcmPhoneLineCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * CCM_PHONE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return CCM_PHONE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbCcmPhoneCsvFileName() {
        String value = props.getProperty("DbCcmPhoneCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbCcmPhoneCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * R_CCM_USER_PHONE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return R_CCM_USER_PHONE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbRCcmUserPhoneCsvFileName() {
        String value = props.getProperty("DbRCcmUserPhoneCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbRCcmUserPhoneCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * R_SECTION_BRANCH ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return R_SECTION_BRANCH ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbRSectionBranchCsvFileName() {
        String value = props.getProperty("DbRSectionBranchCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbRSectionBranchCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * R_USER_ROLE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return R_USER_ROLE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbRUserRoleCsvFileName() {
        String value = props.getProperty("DbRUserRoleCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbRUserRoleCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * R_USER_SECTION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return R_USER_SECTION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbRUserSectionCsvFileName() {
        String value = props.getProperty("DbRUserSectionCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbRUserSectionCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * SYS_SCHEDULE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return SYS_SCHEDULE ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbSysScheduleCsvFileName() {
        String value = props.getProperty("DbSysScheduleCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbSysScheduleCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * TEL_DIR_ASSOCIATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return TEL_DIR_ASSOCIATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbTelDirAssociationCsvFileName() {
        String value = props.getProperty("DbTelDirAssociationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbTelDirAssociationCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * UNITY_ASSOCIATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return UNITY_ASSOCIATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbCUCAssociationCsvFileName() {
        String value = props.getProperty("DbCUCAssociationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                "environment.propertiesã«" +
                " DbCUCAssociationCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * VOICE_LOGGER_ASSOCIATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return VOICE_LOGGER_ASSOCIATION ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbVoiceLoggerAssociationCsvFileName() {
        String value = props.getProperty("DbVoiceLoggerAssociationCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbVoiceLoggerAssociationCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * CallingSearchSpace ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbCcmCallingSearchSpaceCsvFileName() {
        String value = props.getProperty("DbCcmCallingSearchSpaceCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbCcmCallingSearchSpaceCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * PickupGroupãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbCcmPickupGroupCsvFileName() {
        String value = props.getProperty("DbCcmPickupGroupCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbCcmPickupGroupCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * ExcludeExecutiveãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbExcludeExecutiveCsvFileName() {
        String value = props.getProperty("DbExcludeExecutiveCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbExcludeExecutiveCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * Thresholdãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbThresholdCsvFileName() {
        String value = props.getProperty("DbThresholdCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbThresholdCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
 /**
     * ProductTypeãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å(ä¸€æ‹¬å…¥å‡ºåŠ›ç”¨)
     * @return ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getDbCcmTypeProductCsvFileName() {
        String value = props.getProperty("DbCcmTypeProductCsvFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " DbCcmTypeProductCsvFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
////////////////////////////////////////////////////////////////////////////////////////////////////
// Export CSV ç³»
    /**
     * TelDir å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     * @return å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getExportTelDir() {
        String value = props.getProperty("CsvExport.TelDir");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " CsvExport.TelDir ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * Unity å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     * @return å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getExportCUC() {
        String value = props.getProperty("CsvExport.CUC");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " CsvExport.CUC ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * VoiceLogger å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     * @return å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getExportVoice() {
        String value = props.getProperty("CsvExport.Voice");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " CsvExport.Voice ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * VoiceLogger å…¥åŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     * @return å…¥åŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getImportVoice() {
        String value = props.getProperty("CsvImport.Voice");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " CsvImport.Voice ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * Charge å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     * @return å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getExportCharge() {
        String value = props.getProperty("CsvExport.Charge");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " CsvExport.Charge ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * AD å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     * @return å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getExportAD() {
        String value = props.getProperty("CsvExport.AD");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " CsvExport.AD ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * LineList å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     * @return å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getExportLineList() {
        String value = props.getProperty("CsvExport.LineList");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " CsvExport.LineList ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * Manage å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     * @return å‡ºåŠ›CSVãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getExportManage() {
        String value = props.getProperty("CsvExport.Manage");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " CsvExport.Manage ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
////////////////////////////////////////////////////////////////////////////////////////////////////


    /**
     * ãƒãƒƒãƒæˆå¦åˆ¤å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return ãƒãƒƒãƒæˆå¦åˆ¤å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getBatchJudgeDir() {
        String value = props.getProperty("BatchJudgeDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«BatchJudgeDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
 /**
     * ãƒãƒƒãƒæˆå¦åˆ¤å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å–å¾—
     * @return ãƒãƒƒãƒæˆå¦åˆ¤å®šãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getBatchJudgeFileName(String propName) {
        String value = props.getProperty(propName);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«BatchJudgeFile.*ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ãƒ­ã‚°ã‚¤ãƒ³JSPãƒ•ã‚¡ã‚¤ãƒ«ã®å–å¾—
     * @return ãƒ­ã‚°ã‚¤ãƒ³JSPãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getMaintenanceFileName(String propName) {
        String value = props.getProperty(propName);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«[" + propName + "]ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ãƒ­ã‚°ã‚¤ãƒ³JSPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return ãƒ­ã‚°ã‚¤ãƒ³JSPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getLoginDir() {
        String value = props.getProperty("LoginDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«LoginDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç”¨ãƒ­ã‚°ã‚¤ãƒ³JSPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç”¨ãƒ­ã‚°ã‚¤ãƒ³JSPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getMaintenanceLoginDir() {
        String value = props.getProperty("MaintenanceLoginDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«MaintenanceLoginDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * web.xmlæ ¼ç´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—
     * @return web.xmlæ ¼ç´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
     */
    public String getWebXmlDir() {
        String value = props.getProperty("WebXmlDir."+osType);
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«WebXmlDirã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }


////////////////////////////////////////////////////////////////////////////////////////////////////
// äººäº‹æƒ…å ±å–è¾¼ãƒãƒƒãƒç”¨ /////
    /**
     * EOFAD ãƒ•ã‚¡ã‚¤ãƒ«å
     * @return ãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getEofAd() {
        String value = props.getProperty("Eof.Ad");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " Eof.Ad ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * EOFAM ãƒ•ã‚¡ã‚¤ãƒ«å
     * @return ãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getEofAm() {
        String value = props.getProperty("Eof.Am");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã«" +
                    " Eof.Am ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizOrganizationã®Csvã®Headerã‚’å–å¾—
     * @return BizOrganizationCsvHeader
     */
    public String getBizOrganizationCsvHeader() {
        String value = props.getProperty("BizOrganizationCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizOrganizationCsvHeader ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizDepartmentã®Csvã®Headerã‚’å–å¾—
     * @return BizDepartmentCsvHeader
     */
    public String getBizDepartmentCsvHeader() {
        String value = props.getProperty("BizDepartmentCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizDepartmentCsvHeader ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizEmployeeã®Csvã®Headerã‚’å–å¾—
     * @return BizEmployeeCsvHeader
     */
    public String getBizEmployeeCsvHeader() {
        String value = props.getProperty("BizEmployeeCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizEmployeeCsvHeader ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizADã®Csvã®Headerã‚’å–å¾—
     * @return BizADCsvHeader
     */
    public String getBizAdCsvHeader() {
        String value = props.getProperty("BizAdCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizAdCsvHeader ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizShiftã®Csvã®Headerã‚’å–å¾—
     * @return BizShiftCsvHeader
     */
    public String getBizShiftCsvHeader() {
        String value = props.getProperty("BizShiftCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizShiftCsvHeader ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizOrganizationã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizOrganizationãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getBizOrganizationTableName() {
        String value = props.getProperty("BizOrganizationTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizOrganizationTableName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizDepartmentã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizDepartmentãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getBizDepartmentTableName() {
        String value = props.getProperty("BizDepartmentTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizDepartmentTableName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
  /**
     * BizEmployeeã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizEmployeeãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getBizEmployeeTableName() {
        String value = props.getProperty("BizEmployeeTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizEmployeeTableName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizAdã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizAdãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getBizAdTableName() {
        String value = props.getProperty("BizAdTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizAdTableName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * BizShiftã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizShiftãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getBizShiftTableName() {
        String value = props.getProperty("BizShiftTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« BizShiftTableName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * RetiredUserã®å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—
     * @return RetiredUserå‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getRetiredUserFileName() {
        String value = props.getProperty("RetiredUserFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« RetiredUserFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
    /**
     * JoinedUserã®å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—
     * @return JoinedUserå‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å
     */
    public String getJoinedUserFileName() {
        String value = props.getProperty("JoinedUserFileName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« JoinedUserFileName ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * BizOrganizationã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizOrganizationã®ãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getTmpBizOrganizationTableName() {
        String value = props.getProperty("TmpBizOrganizationTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«BizOrganizationTableNameã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * BizDepartmentã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizDepartmentã®ãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getTmpBizDepartmentTableName() {
        String value = props.getProperty("TmpBizDepartmentTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«BizDepartmentTableNameã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * BizEmployeeã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizEmployeeã®ãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getTmpBizEmployeeTableName() {
        String value = props.getProperty("TmpBizEmployeeTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«BizEmployeeTableNameã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * BizAdã®ãƒ†ãƒ¼ãƒ–ãƒ«åã‚’å–å¾—
     * @return BizAdã®ãƒ†ãƒ¼ãƒ–ãƒ«å
     */
    public String getTmpBizAdTableName() {
        String value = props.getProperty("TmpBizAdTableName");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«BizAdTableNameã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * BizOrganization@Csv Headerã‚’å–å¾—
     *
     * @return BizOrganizationCsvHeader
     */
    public String getTmpBizOrganizationCsvHeader() {
        String value = props.getProperty("TmpBizOrganizationCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«BizOrganizationCsvHeadersã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * BizEmployee@Csv Headerã‚’å–å¾—
     *
     * @return TmpBizEmployeeCsvHeader
     */
    public String getTmpBizEmployeeCsvHeader() {
        String value = props.getProperty("TmpBizEmployeeCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«BizEmployeeCsvHeadersã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }
  /**
     * BizDepartment@Csv Headerã‚’å–å¾—
     *
     * @return BizDepartmentCsvHeader
     */
    public String getTmpBizDepartmentCsvHeader() {
        String value = props.getProperty("TmpBizDepartmentCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«BizDepartmentCsvHeadersã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    /**
     * BizAdCsvHeader@Csv Headerã‚’å–å¾—
     *
     * @return BizAdCsvHeaderCsvHeader
     */
    public String getTmpBizAdCsvHeader() {
        String value = props.getProperty("TmpBizAdCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException("environment.propertiesã«BizAdCsvHeadersã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

////////////////////////////////////////////////////////////////////////////////////////////////////
    /**
     * Chargeã®Csvã®Headerã‚’å–å¾—
     * @return ChargeCsvHeader
     */
    public String getChargeCsvHeader() {
        String value = props.getProperty("ChargeCsvHeader");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« ChargeCsvHeader ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

    // ALL TABLE EXP IMP
    /**
     * ä¸€æ‹¬å‡ºåŠ›ç”¨å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«åä¸€è¦§å–å¾—
     * @return ä¸€æ‹¬å‡ºåŠ›å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«
     */
    public String getAllTableName() {
        String value = props.getProperty("AllTable");
        if (value == null || value.equals("")) {
            throw new BatRuntimeException(
                    "environment.propertiesã« AllTable ã®å®šç¾©ãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
        }
        return value;
    }

}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.netmarks.batch.component

``
`batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.netmarks.batch.component/LoadStaffInfoLogic.java`

```java
package jp.co.netmarks.batch.component;

import java.io.File;
import java.io.IOException;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;
import java.util.Map;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import jp.co.ksc.batch.exception.BatRuntimeException;
import jp.co.ksc.batch.exception.CSVException;
import jp.co.ksc.batch.util.BatchSettings;
import jp.co.ksc.batch.util.CSVUtil;
import jp.co.ksc.batch.util.ErrorFileManager;
import jp.co.ksc.batch.util.LoadStaffInfoWriter;
import jp.co.netmarks.batch.dao.StaffInfoDAO;

/**
 * <p>Title: LoadStaffInfoLogic.java</p>
  * <pre>
  * äººäº‹æƒ…å ±å–è¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯
  * </pre>
* @Time:2023/06/28
* @author Yao KaiKyou
 */
@Component
public class LoadStaffInfoLogic {

    /** ãƒ­ã‚°å‡ºåŠ›ã‚¯ãƒ©ã‚¹*/
    private Log log = LogFactory.getLog(this.getClass());

    @Autowired
    private StaffInfoDAO dao;


    // ************************************************
    // é€£æºãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»å‹•
    // ************************************************
    /**
     * é€£æºãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»å‹•
     * @param props BatchSettings
     */
    public void movFiles(BatchSettings props) {
            String importDir = props.getReceiveDir();
            String exportDir = props.getCsvFtpDir();

            try {
                LoadStaffInfoWriter writer = new LoadStaffInfoWriter(importDir, exportDir);
                List<Object> plist = new ArrayList<>();
                writer.write(plist);
            } catch (Exception e) {
                System.out.println("ãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹•ã«å¤±æ•—ã—ã¾ã—ãŸ");
                e.printStackTrace();
            }
    }

    // ************************************************
    // å¿…é ˆCSVãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    // ************************************************
    /**
     * å¿…é ˆCSVãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯
     * @param fileNames
     * @return ALLæœ‰ã‚Š True ä»¥å¤– False
     */
    public boolean existsIndispensableCsvFile(String[] fileNames) {
        boolean ret = true;

        for (int i = 0; i < fileNames.length; i++) {
            File file = new File(fileNames[i]);
            ret = file.isFile();

            if (!ret) {
            	log.debug("CSVãƒ•ã‚¡ã‚¤ãƒ«[" + fileNames[i] + "]ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚");
            	return ret;
            }
        }
        return ret;
    }

    // ************************************************
    // ï¼£ï¼³ï¼¶å‡¦ç†
    // ************************************************
    /**
     * CSV (ORGANIZATION)å–è¾¼ã¿
     *
     * @param setting BatchSettings
     * @throws IOException
     * @throws CSVException
     * @throws SQLException
     */
    public void doBizOrganization(BatchSettings setting) throws IOException, CSVException, SQLException {
        // CSVãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼ã¿
        String[] header = setting.getTmpBizOrganizationCsvHeader().split(", ", 0);
        String tableName = setting.getTmpBizOrganizationTableName();
        Map<String, Object>[] records = readBizCsv(setting.getCsvFtpDir() + setting.getTmpIntOrganizationCsvFileName(), header);

        // CSVãƒ‡ãƒ¼ã‚¿ã‚’BIZãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²
        if (records != null && records.length > 0) {
            log.debug(tableName + "ç™»éŒ²å¯¾è±¡ä»¶æ•°:" + records.length);
            dao.insertBizTableAll(records, tableName, header);
        }
        // BIZãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ãƒ€ãƒŸãƒ¼ç­‰ã‚’å‰Šé™¤
        dao.deleteBizOrganization();
    }

    // -----------------
    // CSV(BizDepartment)å–è¾¼
    // -----------------
     /**
      * CSV(BizDepartment)å–è¾¼
      * @param setting BatchSettings
      * @throws IOException
      * @throws CSVException
      * @throws SQLException
      */
     public void doBizDepartment(BatchSettings setting) throws IOException, CSVException, SQLException {

         // CSVãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼ã¿
         String[] header = setting.getTmpBizDepartmentCsvHeader().split(",",0);
         String tableName = setting.getTmpBizDepartmentTableName();
         Map<String,Object>[] records = readBizCsv(setting.getCsvFtpDir() + setting.getTmpIntDepartmentCsvFileName(), header);

         // CSVãƒ‡ãƒ¼ã‚¿ã‚’BIZãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²
         if (records != null && records.length > 0) {
             log.debug(tableName + "ç™»éŒ²å¯¾è±¡ä»¶æ•°ï¼š" + records.length);
             dao.insertBizTableAll(records, tableName, header);
         }

         // BIZãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ãƒ€ãƒŸãƒ¼ç­‰ã‚’å‰Šé™¤
         dao.deleteBizDepartment();
     }



     // -----------------
     // CSV(BizAd)å–è¾¼
     // -----------------
     /**
      * CSV(BizAd)å–è¾¼
      * @param setting BatchSettings
      * @throws IOException
      * @throws CSVException
      * @throws SQLException
      */
     @SuppressWarnings("unchecked")
     public void doBizAd(BatchSettings setting) throws IOException, CSVException, SQLException {

         // CSVãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼ã¿
         String[] header = setting.getTmpBizAdCsvHeader().split(",",0);
         String tableName = setting.getTmpBizAdTableName();
         Map<String,Object>[] records = readBizCsv(setting.getCsvFtpDir() + setting.getBizAdCsvFileName(), header);

         // CSVãƒ‡ãƒ¼ã‚¿ã‚’BIZãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²
         if (records != null && records.length > 0) {

             List<Map<String,Object>> list = new ArrayList<Map<String,Object>>();
             List<String> addedCodeList = new ArrayList<String>();

             // ç¤¾å“¡ã‚³ãƒ¼ãƒ‰10æ¡ã®å ´åˆã€å…ˆé ­3æ¡ã‚’å–ã‚Šé™¤ã
             for (int i = 0; i < records.length; i++) {

                 String employeeCode = (String) records[i].get("LOGIN_NM");
                 try {
                     Long.parseLong(employeeCode);

                     // 10æ¡ï¼†ä¼šç¤¾ã‚³ãƒ¼ãƒ‰ã€Œ001ã€
                     if (employeeCode.length() != 7 && employeeCode.length() == 10) {
                         records[i].put("LOGIN_NM", employeeCode.substring(employeeCode.length() - 7));
                         log.debug("ç¤¾å“¡ã‚³ãƒ¼ãƒ‰å¤‰æ› å…ƒç¤¾å“¡ã‚³ãƒ¼ãƒ‰ï¼š[" + employeeCode + "] æ–°ç¤¾å“¡ã‚³ãƒ¼ãƒ‰ï¼š[" + records[i].get("LOGIN_NM") + "]");
                     }

                     boolean added = false;
                     for (int j = 0; j < addedCodeList.size(); j++) {
                         String tmpCode = (String) addedCodeList.get(j);
                         if (tmpCode.equals(records[i].get("LOGIN_NM").toString())) {
                             added = true;
                             break;
                         }
                     }
                     if (!added) {
                         log.debug("ADD EmployeeCode:" + records[i].get("LOGIN_NM"));
                         list.add(records[i]);
                         addedCodeList.add(records[i].get("LOGIN_NM").toString());
                     } else {
                         log.debug("ADDED EmployeeCode:" + records[i].get("LOGIN_NM"));
                     }

                 } catch (NumberFormatException nfe) {
                     log.debug("NG EmployeeCode:" + employeeCode);
                 }
             }

             Map<String,Object>[] okRecords = (Map[]) list.toArray(new Map[list.size()]);
             log.debug(tableName + "ç™»éŒ²å¯¾è±¡ä»¶æ•°ï¼š" + okRecords.length);
             dao.insertBizTableAll(okRecords, tableName, header);
         }
     }

  // -----------------
     // CSV(BizEmployee)å–è¾¼
     // -----------------
     /**
      * CSV(BizEmployee)å–è¾¼
      * @param setting BatchSettings
      * @throws IOException
      * @throws CSVException
      * @throws SQLException
      */
     public void doBizEmployee(BatchSettings setting) throws IOException, CSVException, SQLException {

         // CSVãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼ã¿
         String[] header = setting.getTmpBizEmployeeCsvHeader().split(",",0);
         String tableName = setting.getTmpBizEmployeeTableName();
         Map<String,Object>[] records = readBizCsv(setting.getCsvFtpDir() + setting.getBizEmployeeCsvFileName(), header);

         // CSVãƒ‡ãƒ¼ã‚¿ã‚’BIZãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²
         if (records != null && records.length > 0) {
             log.debug(tableName + "ç™»éŒ²å¯¾è±¡ä»¶æ•°ï¼š" + records.length);
             dao.insertBizTableAll(records, tableName, header);
         }
         // BIZãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ãƒ€ãƒŸãƒ¼ç­‰ã‚’å‰Šé™¤
        dao.deleteBizEmployee();
     }

     // ************************************************
     // é€€è·è€…ãƒªã‚¹ãƒˆå‡ºåŠ›
     // ************************************************
     /**
      * é€€è·è€…ãƒªã‚¹ãƒˆå‡ºåŠ›
      * @param props BatchSettings
      * @throws Exception
      */
     public void retiredUserFileOut(BatchSettings props) throws Exception {

  		String outputPath    =  props.getOutPutRetireDir();
  		String retireListNm  =  props.getRetiredUserFileName();

          File backupDir = new File(outputPath);
          if (!backupDir.exists()) {
              backupDir.mkdirs();
          }

          try{
          	Map<String,Object>[] retire = dao.selRetireUser();

  	        // å‡ºåŠ›
  	        CSVUtil csv = new CSVUtil(retire);
              csv.setDataMaps(retire);
              csv.setHasHeader(true);
              csv.addHeader("last_name");
              csv.addHeader("first_name");
              csv.addHeader("telephone_no ");
              csv.addHeader("full_name");
  	        csv.setFileName( outputPath + csv.getTimestampAddFileNM(retireListNm));
  	        csv.write();

          }catch(Exception e){
          	throw e;
          }
      }


     // ************************************************
     // ä¾‹å¤–å‡¦ç† ã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
     // ************************************************
     /**
      * ã‚¨ãƒ©ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
      * @param props BatchSettings
      */
     public void creaErrFile(BatchSettings props) {
         String errorFilePath = props.getOutPutErrFileDir();
         String errorMessage = props.getErrMessage();
 		String outputErrFile = props.getOutPutErrFileNm();
         ErrorFileManager errorFileManager = new ErrorFileManager(errorFilePath, errorMessage, outputErrFile);

         try {
             errorFileManager.checkErrorFileExists();
         } catch (BatRuntimeException e) {
             e.printStackTrace();
         }
     }




  //*********************************
 // å†…éƒ¨å‡¦ç†ãƒ¡ã‚½ãƒƒãƒ‰
 //*********************************
 /**
 * å†…éƒ¨å‡¦ç†ãƒ¡ã‚¤ãƒ³
 *
 *@param todayCsvFileName CSV)71K
 *@param csvHeader A
 *@return èª­ã¿è¾¼ã‚“ã  csvã®å†…å®¹
 *@throws IOException
 *@throws CSVException
 */
 private Map<String, Object>[] readBizCsv(String todayCsvFileName, String[] csvHeader)
             throws IOException, CSVException {
         CSVUtil csvUtil = new CSVUtil(todayCsvFileName);

         if (csvHeader != null) {
             for (int i = 0; i < csvHeader.length; i++) {
                 csvUtil.addHeader(csvHeader[i]);
             }
         } else {
             log.warn("CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");
             throw new CSVException();
         }

         try {
             csvUtil.read();
             log.debug("CSVãƒ•ã‚¡ã‚¤ãƒ«[" + todayCsvFileName + "]èª­è¾¼ã¿æˆåŠŸ");
         } catch (IOException ioe) {
             log.warn("CSVãƒ•ã‚¡ã‚¤ãƒ«[" + todayCsvFileName + "]èª­è¾¼ã¿ã‚¨ãƒ©ãƒ¼(IOException)");
             throw ioe;
         } catch (CSVException csve) {
             log.warn("CSVãƒ•ã‚¡ã‚¤ãƒ«[" + todayCsvFileName + "]èª­è¾¼ã¿ã‚¨ãƒ©ãƒ¼(CSVException)");
             throw csve;
         }

         return csvUtil.getDataMaps();
     }

 // ************************************************
 // CSVãƒ•ã‚¡ã‚¤ãƒ«ãƒªãƒãƒ¼ãƒ 
 // ************************************************
 /**
  * CSVãƒ•ã‚¡ã‚¤ãƒ«ãƒªãƒãƒ¼ãƒ 
  * @param props BatchSettings
  * @throws IOException
  */
 public void csvFileRename(BatchSettings props) throws IOException {

		String impcsvPath    =  props.getCsvFtpDir();
		String impcmpcsvPath =  props.getInputCompDir();
		String[] impcsv      = {props.getEofAd(),
								props.getEofAm(),
								props.getTmpAdCsvFileName(),
								props.getTmpIntDepartmentCsvFileName(),
								props.getTmpIntEmployeeCsvFileName(),
								props.getTmpIntOrganizationCsvFileName()
								};

     File backupDir = new File(impcmpcsvPath);
     if (!backupDir.exists()) {
         backupDir.mkdirs();
     }

     Calendar cal = Calendar.getInstance();
     SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMddHHmmss");
     String ymdhms = sdf.format(cal.getTime());

     for (int i = 0; i < impcsv.length; i++) {
         String todayCsvFileName = impcsv[i];
         String[] csvSplit = todayCsvFileName.split("\\.", 0);

         File importCsvFile = new File(impcsvPath + todayCsvFileName);
         if (importCsvFile.exists()) {
         	String newFilenm = "";
         	if(i<2){
         		newFilenm =  backupDir + "/" + todayCsvFileName + "_IMPORTED_" + ymdhms;
         	}else{
         		newFilenm =  backupDir + "/" + csvSplit[0] + "_IMPORTED_" + ymdhms + "." + csvSplit[1];
         	}
         	File renameCsvFile = new File(newFilenm);
             importCsvFile.renameTo(renameCsvFile);
         }
     }
 }


}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.netmarks.batch.dao

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.netmarks.batch.dao/StaffInfoDAO.java`

```java
package jp.co.netmarks.batch.dao;

import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Properties;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import jp.co.ksc.batch.util.NewUserFileOutput;
import jp.co.netmarks.batch.persistence.LoadStaffMapper;
import jp.co.netmarks.util.ErrorMail;

/**
 * <p>Title: StaffInfoDAO.java</p>
  * <pre>
  * äººäº‹æƒ…å ±å–è¾¼ã¿é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œDAOã‚¯ãƒ©ã‚¹
  * </pre>
* @Time:2023/06/27
* @author Yao KaiKyou
 */
@Component
public class StaffInfoDAO {

	/* ãƒ­ã‚°å‡ºåŠ›ã‚¯ãƒ©ã‚¹ */
	private Log log = LogFactory.getLog(this.getClass());

	@Autowired
	private LoadStaffMapper lsm;

    @Autowired
    private ErrorMail errMail;

    private List<Map<String,Object>> newEmployeeRecords;

	@Autowired
	private Properties properties;

	// *****************
	// CSVå‡¦ç†
	// *****************

	/**
	 * Bizç³»ãƒ†ãƒ¼ãƒ–ãƒ«ã®CSVå–è¾¼ã‚’è¡Œã„ã¾ã™
	 *
	 * @param records   ãƒ‡ãƒ¼ã‚¿
	 * @param tableName ãƒ†ãƒ¼ãƒ–ãƒ«å
	 * @param header    é…åˆ—
	 * @throws SQLException
	 */
	public void insertBizTableAll(Map<String, Object>[] records, String tableName, String[] header)
			throws SQLException {
		Map<String, Object> param = new HashMap<String, Object>();
		if (records != null) {
			try {
				for (int i = 0; i < records.length; i++) {
					StringBuffer recordLog = new StringBuffer();
					for (int j = 0; j < header.length; j++) {
						if (j == 0) {
							recordLog.append(header[j] + ":" + records[i].get(header[j]));
						} else {
							recordLog.append(", " + header[j] + ":" + records[i].get(header[j]));
							System.out.println(header[j] + ":" + records[i].get(header[j]));
						}

						param.put(header[j], records[i].get(header[j]));
					}

					if (tableName.equals("TMP_AD")) {
						if (param.get("LAST_NM") == null)
							param.put("LAST_NM", param.get("LOGIN_NM"));
						if (param.get("FIRST_NM") == null)
							param.put("FIRST_NM", param.get("LOGIN_NM"));
						lsm.insertBizAD(param);
					} else if (tableName.equals("TMP_INTEGRATEDID_DEPARTMENT")) {
						lsm.insertBizDepartment(param);
					} else if (tableName.equals("TMP_INTEGRATEDID_EMPLOYEE")) {
						lsm.insertBizEmployee(param);
					} else if (tableName.equals("TMP_INTEGRATEDID_ORGANIZATION")) {
						lsm.insertBizOrganization(param);
					} else if (tableName.equals("BIZ_SHIFT")) {
						lsm.insertBizShift(param);
					}
				}
			} catch (Exception e) {
				log.warn("BIZãƒ†ãƒ¼ãƒ–ãƒ«[" + tableName + "]ç™»éŒ²ã‚¨ãƒ©ãƒ¼");
				throw e;
			}
		}
	}

	/**
	*BizOrganizationã®å‰Šé™¤
	*@throws SQLException
	*/
	public void deleteBizOrganization() throws SQLException {
		try {
			lsm.deleteDumOrganization();
		} catch (Exception e) {
			log.warn("BIZ_ORGANIZATION å‰Šé™¤ã‚¨ãƒ©ãƒ¼:DUM_ORGANIZATION");
			throw e;
		}
	}

	/**
	*BizDepartmentã®å‰Šé™¤
	*@throws SQLException
	*/
	public void deleteBizDepartment() throws SQLException {
		try {
			lsm.deleteDumDepartment();
		} catch (Exception e) {
			log.warn("BIZ_DEPARTMENT å‰Šé™¤ã‚¨ãƒ©ãƒ¼:DUM_DEPARTMENT");
			throw e;
		}
	}

    /**
     * BizEmployeeã®å‰Šé™¤
     * @throws SQLException
     */
    public void deleteBizEmployee() throws SQLException {
        try {
            lsm.deleteDumEmployee();
        } catch (Exception e) {
            log.warn("BIZ_EMPLOYEE å‰Šé™¤ ã‚¨ãƒ©ãƒ¼:DUM_EMPLOYEE");
            throw e;
        }
    }

    // ************************************************
    // åº—éƒ¨èª² è¿½åŠ 
    // ************************************************
    /**
     * åº—éƒ¨èª²è¿½åŠ å‡¦ç†
     * @return è¿½åŠ ä»¶æ•°
     * @throws SQLException
     */
    public int insertMSection() throws SQLException {
        int ret = 0;
        try {
            List<Map<String,Object>> records = lsm.selNotExistMSection();
            if (records != null && records.size() > 0) {
                for (int i = 0; i < records.size(); i++) {

                    Map<String,Object> param = new HashMap<String, Object>();
                    String companyCode = records.get(i).get("company_cd").toString();
                    System.out.println(companyCode);
                    String departmentCode = records.get(i).get("department_cd").toString();
                    System.out.println(departmentCode);
                    System.out.println("123456mst");
                    param.put("companyCode",companyCode);
                    param.put("departmentCode",departmentCode);

                    int insCnt = lsm.selinsMSection(param);

                    if (insCnt == 0) {
                    	// biz_organizationã«ã€å¯¾å¿œã™ã‚‹çµ„ç¹”ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ãªã‹ã£ãŸã¨ã
                        log.error("åº—éƒ¨èª²ãƒã‚¹ã‚¿[M_SECTION]BIZ_ORGANIZATION ã‚¨ãƒ©ãƒ¼:insertMSection()");
                    	log.error("company_cd = " + companyCode + ", company_cd = " + departmentCode);
                    	throw new SQLException();
                    } else {
	                    ret = ret + 1;
                    }
                }
            }
        } catch (SQLException se) {
            log.warn("åº—éƒ¨èª²ãƒã‚¹ã‚¿[M_SECTION]ç™»éŒ² ã‚¨ãƒ©ãƒ¼ï¼ insertMSection()");
            throw se;
        }
        return ret;
    }

// ************************************************
    // åº—éƒ¨èª² æ›´æ–°
    // ************************************************
    /**
     * åº—éƒ¨èª²æ›´æ–°å‡¦ç†
     * @return ä»¶æ•°
     * @throws SQLException
     */
    public int updateMSection() throws SQLException {
        int ret = 0;
        try {
        	List<Map<String,Object>> records = lsm.selExistMSection();

            if (records != null && records.size() > 0) {
                for (int i = 0; i < records.size(); i++) {

                    Map<String,Object> param = new HashMap<String, Object>();
                    String companyCode = records.get(i).get("company_cd").toString();
                    String departmentCode = records.get(i).get("department_cd").toString();
                    param.put("companyCode",companyCode);
                    param.put("departmentCode",departmentCode);

                    Map<String,Object> resultMap = lsm.selDiffMSection(param);

                    if(resultMap != null){
                        if (resultMap.get("depprord") == null) {
                        	// biz_organizationã«ã€å¯¾å¿œã™ã‚‹çµ„ç¹”ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ãªã‹ã£ãŸã¨ã
                            log.error("åº—éƒ¨èª²ãƒã‚¹ã‚¿[M_SECTION]BIZ_ORGANIZATION ã‚¨ãƒ©ãƒ¼:updateMSection()");
                        	log.error("company_cd = " + companyCode + ", department_cd = " + departmentCode);
                        	throw new SQLException();
                        } else {
                        	param.put("department_nm", resultMap.get("deptnm"));
                        	param.put("parent_department_cd", resultMap.get("pdeptid"));
                        	param.put("organization_cd", resultMap.get("orgcd"));
                        	param.put("print_order", resultMap.get("depprord"));

    	                    int updateCnt = lsm.updateMSection(param);
    	                    if(updateCnt==0){
    	                    	log.error("åº—éƒ¨èª²ãƒã‚¹ã‚¿[M_SECTION]UPDATE 0ä»¶ ã‚¨ãƒ©ãƒ¼:updateMSection()");
                            	throw new SQLException();
    	                    }
                            ret = ret + updateCnt;
                        }
                    }
                }
            }
        } catch (SQLException se) {
            log.warn("åº—éƒ¨èª²ãƒã‚¹ã‚¿[M_SECTION]æ›´æ–° ã‚¨ãƒ©ãƒ¼ï¼ updateMSection()");
            throw se;
        }
        return ret;
    }

    // ************************************************
    // é€€ç¤¾ â€» æ­£ç¤¾å“¡ä»¥å¤–ã‚‚æ¶ˆã™ï¼ˆFULLTIME_EMPï¼š1,2ä»¥å¤–)
    // ************************************************
    /**
     * é€€ç¤¾å‡¦ç†
     * @return é€€ç¤¾äººæ•°
     * @throws SQLException
     */
    public int retireAppUser() throws SQLException {
        int ret = 0;

        try {
        	List<Map<String,Object>> records = lsm.selRetireUsers();

            if (records != null && records.size() > 0) {
                for (int i = 0; i < records.size(); i++) {

                    Map<String,Object> param = new HashMap<String, Object>();
                    String appUserId = records.get(i).get("user_id").toString();
                    param.put("user_id",Integer.parseInt(appUserId));

                    // APP_USER
                    int updCntDelEmp = lsm.updDelEmpAppUser(param);
                    if(updCntDelEmp==0){
                    	log.error("ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[APP_USER]UPDATE 0ä»¶ ã‚¨ãƒ©ãƒ¼:retireEmployee");
                    	throw new SQLException();
                    }

                    // R_CUCM_USER_PHONE
                    updCntDelEmp = lsm.updDelEmpRUserPhone(param);


                    // PhoneOwnerå¯¾å¿œ
                    List<Map<String,Object>> phoneList = lsm.delUserToPhone(param);
                    for (int j=0;j<phoneList.size();j++){
		                param.put("phoneId", phoneList.get(j).get("phoneid"));
		                Map<String,Object> newOwner = lsm.delUserNewOwnerPhone(param);
		                if(newOwner != null){
		                	String newOner = newOwner.get("cucm_login_id").toString();
		                	param.put("newOwner",Integer.parseInt(newOner));

			                updCntDelEmp = lsm.updDelEmpPhoneOwner(param);
		                }else{
			                param.put("newOwner", null);
			                updCntDelEmp = lsm.updDelEmpPhoneOwner(param);
		                }
                    }
                    ret = ret + 1;
                }
            }
        } catch (SQLException se) {
            log.warn("é€€ç¤¾ ã‚¨ãƒ©ãƒ¼ï¼ retireEmployee()");
            throw se;
        }
        return ret;
    }

 // ************************************************
 // ç¤¾å“¡ã€€è¿½åŠ 
 // ************************************************
 /**
  * ç¤¾å“¡è¿½åŠ 
  * @return ä»¶æ•°
  * @throws SQLException
  */
    public int additionAppUser() throws SQLException {
        int ret = 0;
        boolean error = false; // å–ã‚Šè¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹
        String errorlog = null;

        try {
            newEmployeeRecords = lsm.selAdditionUsers();
            System.out.println("cdcd----newEmployeeRecords-------"+newEmployeeRecords);
            System.out.println("æ–°å…¥ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ç›´å‰ã®ãƒ‡ãƒ¼ã‚¿çŠ¶æ³:");
            for (Map<String, Object> record : newEmployeeRecords) {
                String employeeCode = (String) record.get("employee_cd");
                System.out.println("ç¤¾å“¡ã‚³ãƒ¼ãƒ‰: " + employeeCode);
                // å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã—ã¦è¡¨ç¤ºã—ã¾ã™
            }

            if (newEmployeeRecords != null && newEmployeeRecords.size() > 0) {
                List<String> employeeIds = new ArrayList<>();

                for (int i = 0; i < newEmployeeRecords.size(); i++) {
                    Map<String,Object> param = new HashMap<String, Object>();
                    String employee_cd = newEmployeeRecords.get(i).get("employee_cd").toString();
                    param.put("employee_cd", employee_cd);

                    Map<String,Object> record = lsm.selAdditionUserDetail(param);

                    // ADã«å¯¾å¿œã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã‹ã£ãŸå ´åˆã‚’è€ƒæ…®
                    if ((record != null) && (record.get("fulltime_employee") != null)) {
                        // ä¾‹: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æŒ¿å…¥ç›´å‰ã«å¤‰æ•°ã®å€¤ã‚’è¡¨ç¤º
                        System.out.println("æŒ¿å…¥å‰ã®å¤‰æ•°ã®å€¤: " + employee_cd);
                        log.debug("æŒ¿å…¥å‰ã®å¤‰æ•°ã®å€¤: " + employee_cd);

                        System.out.println("param: " + param);
                        System.out.println("æŒ¿å…¥å‰ã®å¤‰æ•°ã®å€¤: " + employee_cd);
                        log.debug("æŒ¿å…¥å‰ã®å¤‰æ•°ã®å€¤: " + employee_cd);

                        System.out.println("param: " + param);
                        int addUserCnt = lsm.insAdditionUserDetail(param);
                        if(addUserCnt == 0) {
                            log.error("ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[APP_USER]Insert 0ä»¶ ã‚¨ãƒ©ãƒ¼:additionEmployee");
                            throw new SQLException();
                        }
                        log.info("æ–°å…¥ç¤¾å“¡ employeeCode : " + employee_cd);
                        ret = ret + 1;

                        // ãƒ¦ãƒ¼ã‚¶ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã®ãŸã‚ã®ç¤¾å“¡ã‚³ãƒ¼ãƒ‰ã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ 
                        employeeIds.add(employee_cd);
                    } else {
                        errorlog = "ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[APP_USER]ADå­˜åœ¨ç„¡ ã‚¨ãƒ©ãƒ¼:additionEmployee ";
                        errorlog += "employee_code=" + employee_cd;
                        log.error(errorlog);
                        error = true;
                    }
                }

                try {
                    NewUserFileOutput newUserFileOutput = new NewUserFileOutput(properties);
                    newUserFileOutput.newUserFileOut(this, employeeIds);
                } catch (Exception e) {
                    log.error("æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã‚¨ãƒ©ãƒ¼: " + e.getMessage());
                    throw new SQLException();
                }
            }

            // å–ã‚Šè¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒã‚ã£ãŸå ´åˆã«ã¯ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡
            if (error) {
                errMail.sendErrorMail(errorlog);
            }
        } catch (SQLException se) {
            log.warn("ç¤¾å“¡[APP_USER]ç™»éŒ² ã‚¨ãƒ©ãƒ¼ï¼ insertAppUser()");
            throw se;
        }

        return ret;
    }

 // ************************************************
    // ç¤¾å“¡ã€€æ›´æ–°
    // ************************************************
    /**
     * ç¤¾å“¡æ›´æ–°å‡¦ç†
     * @return ä»¶æ•°
     * @throws SQLException
     */
    public int updateAppUser() throws SQLException {
        int ret = 0;
        boolean error = false; // å–ã‚Šè¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹
        String errorlog = null;

        try {
        	List<Map<String,Object>> records = lsm.selExistAppUser();

            if (records != null && records.size() > 0) {
                for (int i = 0; i < records.size(); i++) {

                    Map<String,Object> param = new HashMap<String, Object>();
                    String employeeCode = records.get(i).get("employee_cd").toString();
                    param.put("employeeCode",employeeCode);

                    Map<String,Object> resultMap = lsm.selDiffAppUser(param);

                    if(resultMap != null){
                        if (resultMap.get("bzfullemp") == null) {
                        	// ADã«å¯¾å¿œã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã‹ã£ãŸå ´åˆã‚’è€ƒæ…®
                        	error = true;
                        	errorlog = "ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[APP_USER]ADå­˜åœ¨ç„¡ ã‚¨ãƒ©ãƒ¼:updateAppUser ";
                        	errorlog += "employee_code=" + employeeCode;
                        	log.error(errorlog);
                        } else {
                        	param.put("fulltime_employee", resultMap.get("bzfullemp"));
                        	param.put("user_nm_kanji", resultMap.get("bzkanji"));
                        	param.put("user_nm_kana", resultMap.get("bzkana"));
                        	param.put("birthday", resultMap.get("bzbirth"));
                        	param.put("first_nm", resultMap.get("bzfirstnm"));
                        	param.put("last_nm", resultMap.get("bzlastnm"));
                        	param.put("department", resultMap.get("bzdepartment"));

    	                    int updateCnt = lsm.updateAppUser(param);
    	                    if(updateCnt==0){
    	                    	log.error("ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[APP_USER]UPDATE0ä»¶ ã‚¨ãƒ©ãƒ¼:updateAppUser");
                            	throw new SQLException();
    	                    }
    	                    int updateTrnCnt = lsm.updateTrnPhone(param);
    	                    if(updateTrnCnt==0){
    	                    	log.error("trn_phone[APP_USER]UPDATE0ä»¶ ã‚¨ãƒ©ãƒ¼:updateTrnPhone");
                            	throw new SQLException();
    	                    }
                            ret = ret + updateCnt;
                        }
                    }
                }
            }
            // å–ã‚Šè¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒã‚ã£ãŸå ´åˆã«ã¯ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡
            if (error) {
            	errMail.sendErrorMail(errorlog);
            }
        } catch (SQLException se) {
            log.warn("ç¤¾å“¡[APP_USER]æ›´æ–° ã‚¨ãƒ©ãƒ¼ï¼ updateAppUser()");
            throw se;
        }
        return ret;
    }

    // ************************************************
    // æ‰€å±è¿½åŠ  â€»å…¥ç¤¾ã€ç€ä»»
    // ************************************************
    /**
     * æ‰€å±è¿½åŠ  â€»å…¥ç¤¾ã€ç€ä»»
     * @return ä»¶æ•°
     * @throws SQLException
     */
    public int additionRUserSection() throws SQLException {
        int ret = 0;
        boolean error = false; // å–ã‚Šè¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹
        StringBuffer errorlogbuf = new StringBuffer();
        String errorlog = null;
        try {

        	List<Map<String,Object>> records = lsm.selAdditionUserSection();

            if (records != null && records.size() > 0) {

                for (int i = 0; i < records.size(); i++) {
                    Map<String,Object> param = new HashMap<String, Object>();
                    String employeeCode = records.get(i).get("employee_cd").toString();
                    String companyCode = records.get(i).get("company_cd").toString();
                    String departmentCode = records.get(i).get("department_cd").toString();
                    param.put("employeeCode",employeeCode);
                    param.put("companyCode",companyCode);
                    param.put("departmentCode",departmentCode);
                    System.out.println("employeeCode-----existSec---#"+employeeCode);
                    System.out.println("companyCode-----existSec---#"+companyCode);
                    System.out.println("departmentCode-----existSec---#"+departmentCode);



                    // å­˜åœ¨ã™ã‚‹åº—éƒ¨èª²ã‹ã©ã†ã‹ãƒã‚§ãƒƒã‚¯
                    Map<String,Object> existSec = lsm.selExistDepartment(param);
                    System.out.println("okok-----existSec---#"+existSec);
                    if (existSec != null) {
	                    // æ–°ã—ã„æ‰€å±ãªã‚‰è¿½åŠ 
                    	// è¿½åŠ å¯¾è±¡æƒ…å ±ã®å–å¾—
	                    Map<String,Object>[] record = lsm.selAdditionUserSectionDetail(param);
	                    System.out.println("okok--------#"+record);
	                    if (record != null) {
	                    	int existRSec = lsm.selExistUserSection(param);
	                    	if(existRSec == 0){
			                    int addUserCnt = lsm.insAdditionUserSection(param);
			                    if(addUserCnt==0){
			                    	log.error("ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[APP_USER]Insert 0ä»¶ ã‚¨ãƒ©ãƒ¼:additionEmployee");
			                    	throw new SQLException();
			                    }
			                    ret = ret + 1;
	                    	}
		                } else {
	                    	errorlog = "[R_User_Section]è¿½åŠ  ã‚¨ãƒ©ãƒ¼ : BIZ_EMPLOYEEã¨BIZ_ORGANIZATIONã®ä¸æ•´åˆã®ãŸã‚ã€ç¤¾å“¡ã®æ‰€å±ãŒè¿½åŠ ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚";
	                    	errorlog += "employee_code=" + employeeCode + ", company_code=" + companyCode + ", department_code=" + departmentCode;
	                    	log.error(errorlog);
	                       	errorlogbuf.append("    ");
	                    	errorlogbuf.append(errorlog);
	                    	errorlogbuf.append("\\n");
	                     	error = true;
		                }
                    } else {
                    	errorlog = "[R_User_Section]è¿½åŠ  ã‚¨ãƒ©ãƒ¼ : BIZ_EMPLOYEEã®æ‰€å±ãŒåº—éƒ¨èª²ãƒã‚¹ã‚¿ã«å­˜åœ¨ã—ãªã„ãŸã‚ã€ç¤¾å“¡ã®æ‰€å±ãŒè¿½åŠ ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚";
                    	errorlog += "employee_code=" + employeeCode + ", company_code=" + ", department_code=" + departmentCode;
                    	log.error(errorlog);
                       	errorlogbuf.append("    ");
                    	errorlogbuf.append(errorlog);
                    	errorlogbuf.append("\\n");
                     	error = true;
                    }
                }
            }

            // å–ã‚Šè¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒã‚ã£ãŸå ´åˆã«ã¯ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡
            if (error) {
            	//errMail.sendErrorMail(new String(errorlogbuf));
            }

        } catch (SQLException se) {
            log.warn("æ‰€å±[R_USER_SECTION]ç™»éŒ² ã‚¨ãƒ©ãƒ¼ï¼ insertRUserSetion()");
            throw se;
        }
        return ret;
    }

  // ************************************************
    // æ‰€å±ã€€æ›´æ–°
    // ************************************************
    /**
     * æ‰€å±ã€€æ›´æ–°
     * @return ä»¶æ•°
     * @throws SQLException
     */
    public int updateRUserSetion() throws SQLException {
        int ret = 0;
        try {

        	List<Map<String,Object>> records = lsm.selExistDeptChk();

            if (records != null && records.size() > 0) {
                for (int i = 0; i < records.size(); i++) {

                    Map<String,Object> param = new HashMap<String, Object>();
                    String employeeCode = records.get(i).get("employee_cd").toString();
                    String companyCode = records.get(i).get("company_cd").toString();
                    String departmentCode = records.get(i).get("department_cd").toString();

                    param.put("employeeCode",employeeCode);
                    param.put("companyCode",companyCode);
                    param.put("departmentCode",departmentCode);

                    Map<String,Object> resultMap = lsm.selDiffUserSection(param);

                    if(resultMap != null){
                    	param.put("section_name", resultMap.get("bizdeptnm"));
                    	param.put("print_order", resultMap.get("bizprintord"));
                    	Map<String,Object> uIdResultMap = lsm.selTrnUser(param);
                    	 if(uIdResultMap != null){
                    		 param.put("user_id", resultMap.get("user_id"));
                    		 Map<String,Object> sectionIdResultMap = lsm.selMstSection(param);
                    		 if(sectionIdResultMap != null) {
                    			 param.put("section_id", sectionIdResultMap.get("section_id"));
                    		 }
                    	 }

	                    int updateCnt = lsm.updateUserSection(param);
	                    if(updateCnt==0){
	                    	log.error("ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[R_USER_SECTION]UPDATE0ä»¶ ã‚¨ãƒ©ãƒ¼:updateRUserSetion");
                        	throw new SQLException();
	                    }
                        ret = ret + updateCnt;
                    }
                }
            }
        } catch (SQLException se) {
            log.warn("æ‰€å±[R_USER_SECTION]æ›´æ–° ã‚¨ãƒ©ãƒ¼ï¼ updateRUserSetion()");
            throw se;
        }
        return ret;
    }

    // ************************************************
    // ç•°å‹•ã€€â€»è»¢å‡ºå…ƒ
    // ************************************************
    /**
     * ç•°å‹•ã€€â€»è»¢å‡ºå…ƒ
     * @return ä»¶æ•°
     * @throws SQLException
     */
    public int changePersonnel() throws SQLException {
        int ret = 0;
        try {
        	List<Map<String,Object>> records = lsm.selChangePersonnel();

            if (records != null && records.size() > 0) {
                for (int i = 0; i < records.size(); i++) {

                    Map<String,Object> param = new HashMap<String, Object>();
                    String appUserId = records.get(i).get("user_id").toString();
                    String bizEmployeeId = records.get(i).get("biz_employee_id").toString();
                    String sectionId = records.get(i).get("section_id").toString();

                    param.put("appUserId",Integer.parseInt(appUserId));
                    param.put("sectionId",sectionId);
                    param.put("bizEmployeeId",bizEmployeeId);

                    // è»¢å‡ºå…ƒã§é›»è©±æ©ŸãŒç´ä»˜ã„ã¦ã„ãŸã‹ã©ã†ã‹ãƒã‚§ãƒƒã‚¯
                    int phoneCnt = lsm.selPersonnelUsedPhone(param);

                    // R_USER_SECTION
                    if ( phoneCnt == 0) {
                    	// è»¢å‡ºå…ƒã«ç´ä»˜ã„ãŸé›»è©±æ©ŸãŒãªã„å ´åˆ
                        int deleteCnt = lsm.deleteUserSection(param);
	                    if(deleteCnt==0){
	                    	log.error("ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[R_USER_SECTION]Delete 0ä»¶ ã‚¨ãƒ©ãƒ¼:personnelChanges");
                        	throw new SQLException();
	                    }
                    } else {
                        // æ—¢å®šã§ã¯å‰Šé™¤äºˆç´„ãƒ•ãƒ©ã‚°ã®ã¿ç«‹ã¦ã€è»¢å‡ºå…ƒã§ã‚‚ç”»é¢è¡¨ç¤ºãŒã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
                        int updateCnt = lsm.updDelUserSection(param);
	                    if(updateCnt==0){
	                    	log.error("ãƒ¦ãƒ¼ã‚¶ãƒã‚¹ã‚¿[R_USER_SECTION]UPDATE 0ä»¶ ã‚¨ãƒ©ãƒ¼:personnelChanges");
                        	throw new SQLException();
	                    }
                    }
                    ret = ret + 1;
                }
            }
        } catch (SQLException se) {
            log.warn("ç•°å‹• ã‚¨ãƒ©ãƒ¼ï¼ personnelChanges()");
            throw se;
        }
        return ret;
    }

    // ************************************************
    // é€€ç¤¾ãƒªã‚¹ãƒˆå‡ºåŠ›
    // ************************************************
    /**
     * é€€ç¤¾ãƒªã‚¹ãƒˆå‡ºåŠ›
     * @return é€€ç¤¾ãƒªã‚¹ãƒˆ
     * @throws SQLException
     */
    public Map<String,Object>[] selRetireUser() throws SQLException {
    	Map<String,Object>[] records;
    	records = lsm.selAllRetireUserList();
        return records;
    }

    // ************************************************
    // å…¥ç¤¾ãƒªã‚¹ãƒˆå‡ºåŠ›
    // ************************************************
    /**
     * å…¥ç¤¾ãƒªã‚¹ãƒˆå‡ºåŠ›
     * @param employeeIds å¾“æ¥­å“¡IDã®ãƒªã‚¹ãƒˆ
     * @return å…¥ç¤¾ãƒªã‚¹ãƒˆ
     * @throws SQLException
     */
    public Map<String, Object> selAllNewUserList(String employeeId) throws SQLException {
        try {
        	Map<String, Object>   newUser = lsm.selAllAddUserList(employeeId);
            return newUser;
        } catch (Exception e) {
            log.error("æ–°å…¥ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚", e);
            throw new SQLException("æ–°å…¥ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚", e);
        }
    }



}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.netmarks.batch.persistence

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.netmarks.batch.persistence/LoadStaffMapper.java`

```java
package jp.co.netmarks.batch.persistence;

import java.util.List;
import java.util.Map;

/**
 * <p>Title: LoadStaffMapper.java</p>
  * <pre>
  * äººäº‹æƒ…å ±å–è¾¼é–¢é€£ ãƒãƒƒãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹
  * </pre>
* @Time:2023/06/28
* @author Yao KaiKyou
 */
public interface LoadStaffMapper {

	//vacuum
	/**
	 * äººäº‹æƒ…å ±é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã®Vacuumã‚’å®Ÿè¡Œ
	 * @return int
	 */
	int vacuum();

	// æƒ…å ±å–è¾¼
	/**
	 * BizShiftå‰Šé™¤
	 * @return ä»¶æ•°
	 */
	int deleteBizShift();
	/**
	 * BizADå‰Šé™¤
	 * @return ä»¶æ•°
	 */
	int deleteBizAD();
	/**
	 *  BizOrganizationå‰Šé™¤
	 * @return ä»¶æ•°
	 */
	int deleteBizOrganization();
	/**
	 *  BizDepartmentå‰Šé™¤
	 * @return ä»¶æ•°
	 */
	int deleteBizDepartment();
	/**
	 *  BizEmployeeå‰Šé™¤
	 * @return ä»¶æ•°
	 */
	int deleteBizEmployee();

	/**
	 * DumOrganizationå‰Šé™¤
	 * @return ä»¶æ•°
	 */
	int deleteDumOrganization();
	/**
	 * DumOrganizationå‰Šé™¤
	 * @return ä»¶æ•°
	 */
	int deleteDumDepartment();
	/**
	 * DumOrganizationå‰Šé™¤
	 * @return ä»¶æ•°
	 */
	int deleteDumEmployee();

	/**
	 * BizShiftç™»éŒ²
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int insertBizShift(Map<String, Object> parameterValues);
	/**
	 * BizADç™»éŒ²
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int insertBizAD(Map<String, Object> parameterValues);
	/**
	 * BizOrganizationç™»éŒ²
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int insertBizOrganization(Map<String, Object> parameterValues);
	/**
	 * BizDepartmentç™»éŒ²
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int insertBizDepartment(Map<String, Object> parameterValues);
	/**
	 * BizEmployeeç™»éŒ²
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int insertBizEmployee(Map<String, Object> parameterValues);

	// é–¾å€¤
	/**
	 * é–¾å€¤å–å¾—
	 * @return å–å¾—ã—ãŸé–¾å€¤
	 */
	Map<String, Object> selectThreshold();
	/**
	 * å…¥ç¤¾äººæ•°å–å¾—
	 * @return å–å¾—ã—ãŸå…¥ç¤¾äººæ•°
	 */
	int selectEnterCount();
	/**
	 * ç™»éŒ²ç¤¾å“¡æƒ…å ±å–å¾—
	 * @return å–å¾—ã—ãŸç™»éŒ²ç¤¾å“¡æƒ…å ±
	 */
	List<Map<String, Object>> selectEnterEmployee();
	/**
	 * é€€ç¤¾äººæ•°å–å¾—
	 * @return å–å¾—ã—ãŸé€€ç¤¾äººæ•°
	 */
	int selectRetireCount();
	/**
	 * é€€ç¤¾ç¤¾å“¡æƒ…å ±å–å¾—
	 * @return å–å¾—ã—ãŸé€€ç¤¾ç¤¾å“¡æƒ…å ±
	 */
	List<Map<String, Object>> selectRetireEmployee();
	/**
	 * å¤‰æ›´ç¤¾å“¡äººæ•°å–å¾—
	 * @return å–å¾—ã—ãŸå¤‰æ›´ç¤¾å“¡äººæ•°
	 */
	int selectChangeCount();
	/**
	 * å¤‰æ›´ç¤¾å“¡äººæ•°æƒ…å ±å–å¾—
	 * @return å–å¾—ã—ãŸå¤‰æ›´ç¤¾å“¡æƒ…å ±
	 */
	List<Map<String, Object>> selectChangeEmployee();

	// M_SECTION
	/**
	 * æœªç™»éŒ²MSectionå–å¾—
	 * @return å–å¾—ã—ãŸMSection
	 */
	List<Map<String, Object>> selNotExistMSection();
	/**
	 * ç™»éŒ²æ¸ˆMSectionå–å¾—
	 * @return å–å¾—ã—ãŸMSection
	 */
	List<Map<String, Object>> selExistMSection();
	/**
	 * ç™»éŒ²æƒ…å ±ã¨ç›¸é•ã‚ã‚‹MSectionã®å–å¾—
	 * @param parameterValues
	 * @return å–å¾—ã—ãŸMSectionæƒ…å ±
	 */
	Map<String,Object> selDiffMSection(Map<String,Object>parameterValues);
	/**
	 * æ–°è¦ç™»éŒ²MSection
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int selinsMSection(Map<String,Object> parameterValues);
	/**
	 * MSectionã®æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updateMSection(Map<String,Object> parameterValues);

// APP_USER
	/**
	 * é€€ç¤¾ç¤¾å“¡å–å¾—
	 * @return å–å¾—ã—ãŸé€€ç¤¾ç¤¾å“¡æƒ…å ±
	 */
	List<Map<String,Object>> selRetireUsers();
	/**
	 * é€€ç¤¾äºˆç´„ç¤¾å“¡æ›´æ–°ï¼ˆAppUser)
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updDelEmpAppUser(Map<String,Object> parameterValues);
	/**
	 * é€€ç¤¾äºˆç´„ç¤¾å“¡æ›´æ–°ï¼ˆUserSection)
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updDelEmpRUserSection(Map<String,Object> parameterValues);
	/**
	 * é€€ç¤¾äºˆç´„ç¤¾å“¡æ›´æ–°ï¼ˆUserPhone)
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updDelEmpRUserPhone(Map<String,Object> parameterValues);
	/**
	 * é€€ç¤¾äºˆç´„ç¤¾å“¡æ›´æ–°ï¼ˆTelDir)
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updDelEmpTelDir(Map<String,Object> parameterValues);

	/**
	 * å…¥ç¤¾ç¤¾å“¡ã®å–å¾—
	 * @return å…¥ç¤¾ç¤¾å“¡
	 */
	List<Map<String,Object>> selAdditionUsers();
	/**
	 * å…¥ç¤¾ç¤¾å“¡æƒ…å ±ã®å–å¾—
	 * @param parameterValues
	 * @return å…¥ç¤¾ç¤¾å“¡æƒ…å ±
	 */
	Map<String,Object> selAdditionUserDetail(Map<String,Object> parameterValues);
	/**
	 * å…¥ç¤¾ç¤¾å“¡ã®ç™»éŒ²
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int insAdditionUserDetail(Map<String,Object> parameterValues);

	/**
	 * ç™»éŒ²æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å–å¾—
	 * @return å–å¾—ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼
	 */
	List<Map<String,Object>> selExistAppUser();
	/**
	 * ç™»éŒ²æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ç›¸é•ã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å–å¾—
	 * @param parameterValues
	 * @return ç›¸é•ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
	 */
	Map<String,Object> selDiffAppUser(Map<String,Object>parameterValues);
	/**
	 * trn_phoneã®update_statusæ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updateTrnPhone(Map<String,Object> parameterValues);

	/**
	 * ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updateAppUser(Map<String,Object> parameterValues);

	//R_USER_SECTION
	/**
	 * ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
	 * @return ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
	 */
	List<Map<String,Object>> selAdditionUserSection();
	/**
	 * ç™»éŒ²æ¸ˆéƒ¨ç½²å–å¾—
	 * @param parameterValues
	 * @return ç™»éŒ²æ¸ˆéƒ¨ç½²
	 */
	Map<String,Object> selExistDepartment(Map<String,Object> parameterValues);
	/**
	 * ç™»éŒ²æ¸ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®éƒ¨ç½²ä»¶æ•°ã‚’å–å¾—
	 * @param parameterValues
	 * @return ãƒ¦ãƒ¼ã‚¶ãƒ¼éƒ¨ç½²ä»¶æ•°
	 */
	int selExistUserSection(Map<String,Object> parameterValues);
	/**
	 * ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®éƒ¨ç½²æƒ…å ±å–å¾—
	 * @param parameterValues
	 * @return ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®éƒ¨ç½²æƒ…å ±
	 */
	Map<String,Object>[] selAdditionUserSectionDetail(Map<String,Object> parameterValues);
	/**
	 * ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®éƒ¨ç½²æƒ…å ±ã‚’ç™»éŒ²
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int insAdditionUserSection(Map<String,Object> parameterValues);

	/**
	 * ç™»éŒ²æ¸ˆèª²æƒ…å ±å–å¾—
	 * @return èª²æƒ…å ±
	 */
	List<Map<String,Object>> selExistDeptChk();
	/**
	 * ç™»éŒ²æƒ…å ±ã¨ç›¸é•ã‚ã‚‹Sectionæƒ…å ±å–å¾—
	 * @param parameterValues
	 * @return ç›¸é•ã‚ã‚‹Sectionæƒ…å ±
	 */
	Map<String,Object> selDiffUserSection(Map<String,Object>parameterValues);

	/**
	 * MST_åº—éƒ¨èª²ã€Œmst_sectionã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°ã™ã‚‹å‰ã«åº—éƒ¨èª²IDã‚’å–å¾—ã™ã‚‹
	 * @param parameterValues
	 * @return section_id
	 */
	Map<String,Object> selMstSection(Map<String,Object>parameterValues);

	/**
	 * MST_åº—éƒ¨èª²ã€Œmst_sectionã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°ã™ã‚‹å‰ã«user_idã‚’å–å¾—ã™ã‚‹
	 * @param parameterValues
	 * @return user_id
	 */
	Map<String,Object> selTrnUser(Map<String,Object>parameterValues);


	/**
	 * Sectionæ›´æ–°å‡¦ç†
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updateUserSection(Map<String,Object> parameterValues);

	/**
	 * äººäº‹æƒ…å ±ã®æ›´æ–°å¯¾è±¡å–å¾—
	 * @return æ›´æ–°å¯¾è±¡
	 */
	List<Map<String,Object>> selChangePersonnel();
	/**
	 * ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½¿ç”¨ã—ã¦ã„ã‚‹é›»è©±æ©Ÿã®æ•°ã‚’å–å¾—
	 * @param parameterValues
	 * @return é›»è©±æ©Ÿã®æ•°
	 */
	int selPersonnelUsedPhone(Map<String,Object> parameterValues);
	/**
	 * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰€å±ã‚’å‰Šé™¤
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int deleteUserSection(Map<String,Object> parameterValues);
	/**
	 * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‰€å±ã‚’æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updDelUserSection(Map<String,Object> parameterValues);

	//æ‹ ç‚¹çµ±å»ƒåˆ
	/**
	 * çµ±å»ƒåˆæƒ…å ±ã®å–å¾—
	 * @return çµ±å»ƒåˆæƒ…å ±
	 */
	List<Map<String,Object>> selShiftOrganization();
	/**
	 * ç•°å‹•å‰éƒ¨ç½²ã‹ã‚‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤å¯¾è±¡å–å¾—
	 * @param parameterValues
	 * @return å‰Šé™¤å¯¾è±¡
	 */
	List<Map<String,Object>> selDelAffiliationUser(Map<String,Object> parameterValues);
	/**
	 * ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰€å±éƒ¨ç½²ä»¶æ•°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int selUserSectionCnt(Map<String,Object> parameterValues);
	/**
	 * ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰€å±æƒ…å ±ã®æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updChgPersonnelSection(Map<String,Object> parameterValues);
	/**
	 * ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‰€æŒé›»è©±æ©Ÿã®æƒ…å ±æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updChgPersonnelPhone(Map<String,Object> parameterValues);

/**
	 * ç•°å‹•å‰é›»è©±æ©Ÿæƒ…å ±ã®å‰Šé™¤å¯¾è±¡å–å¾—
	 * @param parameterValues
	 * @return å‰Šé™¤å¯¾è±¡
	 */
	List<Map<String,Object>> selDelAffiliationPhone(Map<String,Object> parameterValues);
	/**
	 * ç•°å‹•å¾Œéƒ¨ç½²CSSåå–å¾—
	 * @param parameterValues
	 * @return æ–°CSSå
	 */
	List<Map<String,Object>> selNewCssNm(Map<String,Object> parameterValues);
	/**
	 * é›»è©±æ©Ÿã®CSSã‚’æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updCssOrgPhone(Map<String,Object> parameterValues);
	/**
	 * ç•°å‹•å¾Œéƒ¨ç½²ã®PickUpåã‚’å–å¾—
	 * @param parameterValues
	 * @return æ–°PickUpå
	 */
	List<Map<String,Object>> selNewPickUpNm(Map<String,Object> parameterValues);
	/**
	 * PickUpNameã®æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updPickUpLine(Map<String,Object> parameterValues);
	/**
	 * è¦ªåº—éƒ¨èª²æƒ…å ±å–å¾—
	 * @param parameterValues
	 * @return è¦ªåº—éƒ¨èª²æƒ…å ±
	 */
	List<Map<String,Object>> selParentSectionId(Map<String,Object> parameterValues);
	/**
	 * çµ„ç¹”æƒ…å ±æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updChgAssociation(Map<String,Object> parameterValues);

	//é€€ç¤¾è€…ãƒªã‚¹ãƒˆ
	/**
	 * é€€ç¤¾ç¤¾å“¡ä¸€è¦§å–å¾—
	 * @return é€€ç¤¾ç¤¾å“¡ä¸€è¦§
	 */
	Map<String,Object>[] selAllRetireUserList();

	//å…¥ç¤¾è€…ãƒªã‚¹ãƒˆ
	/**
	 * å…¥ç¤¾ç¤¾å“¡ä¸€è¦§å–å¾—
	 * @return å…¥ç¤¾ç¤¾å“¡ä¸€è¦§
	 */
	Map<String, Object> selAllAddUserList(String employeeId);

	//é€€ç¤¾è€…ãƒªã‚¹ãƒˆ
	/**
	 * é€€ç¤¾ç¤¾å“¡ä¸€è¦§å–å¾—
	 * @return é€€ç¤¾ç¤¾å“¡ä¸€è¦§
	 */
	Map<String,Object>[] selAllNewUserList(List<String> employeeIds);


	//å‰Šé™¤ãƒ¦ãƒ¼ã‚¶ä½¿ç”¨é›»è©±æ©Ÿã‚ªãƒ¼ãƒŠãƒ¼æ›´æ–°
	/**
	 * å‰Šé™¤ãƒ¦ãƒ¼ã‚¶ä½¿ç”¨é›»è©±æ©Ÿæ•°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	int updDelEmpPhoneOwner(Map<String,Object> parameterValues);
	/**
	 * å‰Šé™¤ãƒ¦ãƒ¼ã‚¶ä½¿ç”¨é›»è©±æ©Ÿå–å¾—
	 * @param parameterValues
	 * @return é›»è©±æ©Ÿä¸€è¦§
	 */
	List<Map<String,Object>> delUserToPhone(Map<String,Object> parameterValues);
	/**
	 * å‰Šé™¤ãƒ¦ãƒ¼ã‚¶ä½¿ç”¨é›»è©±æ©Ÿã‚ªãƒ¼ãƒŠãƒ¼æ›´æ–°
	 * @param parameterValues
	 * @return ä»¶æ•°
	 */
	Map<String,Object> delUserNewOwnerPhone(Map<String,Object> parameterValues);

}

```

`batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/jp.co.netmarks.batch.persistence/MasterMapper.java`

```java
/*
 * Copyright (c) 2014, NET MARKS COMPANY, LIMITED All Rights Reserved.
 *
 * MasterMapper.java
 *
 * @date 2013/09/12
 * @version 1.0
 * @author KSC Hiroaki Endo
 */
package jp.co.netmarks.batch.persistence;

import java.util.List;
import java.util.Map;

/**
 * <pre>
 * Masterãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—ãƒãƒƒãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹
 *
 * &lt;MODIFICATION HISTORY&gt;
 * 1.0 2013/09/12 KSC Hiroaki Endo æ–°è¦ä½œæˆ
 * </pre>
 *
 * @author KSC Hiroaki Endo
 * @version 1.0 2013/09/12
 */
public interface MasterMapper {

	/**
	 * ãƒ•ãƒ«Vacuumã‚’å®Ÿè¡Œ
	 * @return int
	 */
	int fullvacuum();
	/**
	 * æ—¥æ¬¡ç”¨Vacuumã¨Analyzeã‚’å®Ÿè¡Œ
	 * @return int
	 */
	int dayvacuum();
	/**
	 * ãƒã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã®Vacuumã‚’å®Ÿè¡Œ
	 * @return int
	 */
	int vacuum();

	/**
	 * ãƒã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰å‰Šé™¤
	 * @param parameterValues
	 * @return å‰Šé™¤ä»¶æ•°
	 */
	int deleteMaster(Map<String, Object> parameterValues);

	/**
	 * CallingSearchSpaceã®ç™»éŒ²
	 * @param cssParameter
	 * @return ä»¶æ•°
	 */
	int insertCallingSearchSpace(Map<String, Object> cssParameter);
	/**
	 * DevicePoolã®ç™»éŒ²
	 * @param devicePoolParameter
	 * @return ä»¶æ•°
	 */
	int insertDevicePool(Map<String, Object> devicePoolParameter);
	/**
	 * Locationã®ç™»éŒ²
	 * @param locationParameter
	 * @return ä»¶æ•°
	 */
	int insertLocation(Map<String, Object> locationParameter);
	/**
	 * PickupGroupã®ç™»éŒ²
	 * @param pickupParameter
	 * @return ä»¶æ•°
	 */
	int insertPickupGroup(Map<String, Object> pickupParameter);
	/**
	 * PhoneTemplateã®ç™»éŒ²
	 * @param phoneTempParameter
	 * @return ä»¶æ•°
	 */
	int insertPhoneTemplate(Map<String, Object> phoneTempParameter);
	/**
	 * TypeModelã®ç™»éŒ²
	 * @param typeModelParameter
	 * @return ä»¶æ•°
	 */
	int insertTypeModel(Map<String, Object> typeModelParameter);

	/**
	 * ãƒã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å–å¾—
	 * @param parameterValues
	 * @return å–å¾—ã—ãŸãƒã‚¹ã‚¿ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®List
	 */
	List<Map<String, Object>> selectMaster(Map<String, Object> parameterValues);

}
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources.job

`/batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources.job/loadStaffInfo.xml`

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/batch"
              xmlns:beans="http://www.springframework.org/schema/beans"
              xmlns:aop="http://www.springframework.org/schema/aop"
              xmlns:tx="http://www.springframework.org/schema/tx"
              xmlns:p="http://www.springframework.org/schema/p"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="
              http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
              http://www.springframework.org/schema/batch http://www.springframework.org/schema/batch/spring-batch.xsd
              http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
              http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd">

    <!-- äººäº‹æƒ…å ±å–ã‚Šè¾¼ã¿ã‚¸ãƒ§ãƒ– -->
    <job id="loadStaffInfo">
        <step id="staffStep" parent="simpleStep">
            <tasklet>
                <chunk reader="simpleReader" processor="simpleProcessor" writer="loadStaffWriter" commit-interval="10" />
            </tasklet>
        </step>
    </job>

    <beans:bean id="simpleReader" class="jp.co.batch.step.reader.SimpleReader" />
    <beans:bean id="simpleProcessor" class="jp.co.batch.step.processor.SimpleProcessor" />
    <beans:bean id="loadStaffWriter" class="jp.co.batch.step.writer.LoadStaffInfoWriter" />

</beans:beans>

```

`ãƒãƒƒãƒå‡¦ç†/batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources.job/CSVExplmp.xml`

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
	xmlns="http://www.springframework.org/schema/batch"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:tx="http://www.springframework.org/schema/tx"
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/batch http://www.springframework.org/schema/batch/spring-batch-2.1.xsd
		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

<!--
   - CSVã‚¸ãƒ§ãƒ–
   -
-->
<!-- å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€æ‹¬ -->
	<job id="csvAppImport" >
		<step id="appImport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="appCSVImport" />
			</tasklet>
		</step>
	</job>

	<job id="csvAppExport" >
		<step id="appExport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="appCSVExport" />
			</tasklet>
		</step>
	</job>

<!-- èª²é‡‘ -->
	<job id="csvChargeExport" >
		<step id="chargeExport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="chargeCSVExport" />
			</tasklet>
		</step>
	</job>

<!-- é›»å­é›»è©±å¸³ -->
	<job id="csvTelDirExport" >
		<step id="teldirExport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="telDirCSVExport" />
			</tasklet>
		</step>
	</job>

<!-- ãƒ¦ãƒ‹ãƒ†ã‚£ -->
	<job id="csvCUCExport" >
		<step id="CUCExport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="CUCCSVExport" />
			</tasklet>
		</step>
	</job>

<!-- å›ç·šæƒ…å ±ä¸€è¦§ -->
	<job id="csvLineListExport" >
		<step id="lineListExport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="linelistCSVExport" />
			</tasklet>
		</step>
	</job>

<!-- ActiveDirectory -->
	<job id="csvADExport" >
		<step id="actDirExport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="actDirCSVExport" />
			</tasklet>
		</step>
	</job>

<!-- é€šéŒ² -->
	<job id="csvVoiceLoggerImport" >
		<step id="voiceLoggerImport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="voiceLoggerCSVImport" />
			</tasklet>
		</step>
	</job>

	<job id="csvVoiceLoggerExport" >
		<step id="voiceLoggerExport" parent="simpleStep">
			<tasklet>
				<chunk reader="simpleReader" processor="simpleProcessor" writer="voiceLoggerCSVExport" />
			</tasklet>
		</step>
	</job>

	<beans:bean id="simpleReader"          class="jp.co.ksc.batch.step.reader.SimpleReader" />
	<beans:bean id="simpleProcessor"       class="jp.co.ksc.batch.step.processor.SimpleProcessor" />

<!-- å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€æ‹¬ -->
	<beans:bean id="appCSVImport"          class="jp.co.ksc.batch.step.writer.AppCSVImport" />
	<beans:bean id="appCSVExport"          class="jp.co.ksc.batch.step.writer.AppCSVExport" />
<!-- èª²é‡‘ -->
	<beans:bean id="chargeCSVExport"       class="jp.co.ksc.batch.step.writer.ChargeCSVExport" />
<!-- é›»å­é›»è©±å¸³ -->
	<beans:bean id="telDirCSVExport"       class="jp.co.ksc.batch.step.writer.TelDirCSVExport" />
<!-- ãƒ¦ãƒ‹ãƒ†ã‚£ -->
	<beans:bean id="CUCCSVExport"        class="jp.co.ksc.batch.step.writer.CUCCSVExport" />
<!-- å›ç·šæƒ…å ±ä¸€è¦§ -->
	<beans:bean id="linelistCSVExport"     class="jp.co.ksc.batch.step.writer.LineListCSVExport" />
<!-- ActiveDirectory -->
	<beans:bean id="actDirCSVExport"       class="jp.co.ksc.batch.step.writer.ADCSVExport" />
<!-- é€šéŒ² -->
	<beans:bean id="voiceLoggerCSVImport"  class="jp.co.ksc.batch.step.writer.VoiceLoggerCSVImport" />
	<beans:bean id="voiceLoggerCSVExport"  class="jp.co.ksc.batch.step.writer.VoiceLoggerCSVExport" />

</beans:beans>
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources.jp.co.netmarks.batch.persistence

`ãƒãƒƒãƒå‡¦ç†/batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources.jp.co.netmarks.batch.persistence/LoadStaffMapper.xml`

```java
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="jp.co.netmarks.batch.persistence.LoadStaffMapper">

	<update id="vacuum">
		VACUUM (VERBOSE ,ANALYZE) biz_employee;
		VACUUM (VERBOSE ,ANALYZE) biz_shift;
		VACUUM (VERBOSE ,ANALYZE) biz_ad;
		VACUUM (VERBOSE ,ANALYZE) biz_organization;
		VACUUM (VERBOSE ,ANALYZE)
		biz_department;
		VACUUM (VERBOSE ,ANALYZE) app_user;
		VACUUM (VERBOSE
		,ANALYZE) r_user_section;
	</update>

	<!-- é–¾å€¤å–å¾— -->
	<select id="selectThreshold" parameterType="Map"
		resultType="Map">
		select threshold_value from threshold limit 1
	</select>

	<!-- é–¾å€¤(å…¥ç¤¾)å–å¾— -->
	<select id="selectEnterEmployee" resultType="Map">
		select distinct
		employee_code
		from biz_employee
		where employee_code not in
		(select
		biz_employee_id from app_user)
	</select>
	<select id="selectEnterCount" resultType="int">
		select count(1) from (
		select distinct employee_code
		from biz_employee
		where employee_code not in
		(select biz_employee_id from app_user)
		) as EnterCnt
	</select>

	<!-- é–¾å€¤(é€€ç¤¾)å–å¾— -->
	<select id="selectRetireEmployee" resultType="Map">
		select distinct
		biz_employee_id
		from app_user
		where biz_employee_id not in
		(select employee_code from biz_employee)
		and app_user.enabled_shared_use !=
		'1'
	</select>
	<select id="selectRetireCount" resultType="int">
		select count(1) from (
		select distinct app_user_id
		from app_user
		where biz_employee_id not in
		(select employee_code from biz_employee)
		and app_user.enabled_shared_use != '1'
		) as RetireCnt
	</select>

	<!-- é–¾å€¤(ç•°å‹•)å–å¾— -->
	<select id="selectChangeEmployee" resultType="Map">
		select
		A.biz_employee_id,
		R.company_id,
		R.section_id
		from app_user A,
		r_user_section R
		where A.app_user_id = R.app_user_id
		and biz_employee_id in
		(select employee_code
		from biz_employee)
		and (A.biz_employee_id, R.company_id, lpad(R.section_id,
		5, '0')) not
		in (select
		employee_code,
		company_code,
		department_code
		from biz_employee)
	</select>
	<select id="selectChangeCount" resultType="int">
		select count(1) from (
		select A.biz_employee_id,
		R.company_id,
		R.section_id
		from app_user A,
		r_user_section R
		where A.app_user_id = R.app_user_id
		and biz_employee_id in
		(select employee_code
		from biz_employee)
		and (A.biz_employee_id, R.company_id, lpad(R.section_id, 5, '0')) not
		in (select
		employee_code,
		company_code,
		department_code
		from biz_employee)
		) as ChangeCnt
	</select>




	<!-- CSV å–è¾¼ç³» -->

	<insert id="insertBizAD" parameterType="Map">
		insert into
		tmp_ad(login_nm, disp_nm, last_nm, first_nm, mail, position)
		values(#{LOGIN_NM},#{DISP_NM},#{LAST_NM},#{FIRST_NM},#{MAIL},#{POSITION
		})
	</insert>

	<insert id="insertBizDepartment" parameterType="Map">
		insert into
		tmp_integratedid_department(organization_cd, company_cd, company_nm, control_cd, control_nm, charge_cd, charge_nm,  parent_department_cd, parent_department_nm, department_cd, department_nm, department_nm_en, zip_cd, address, telephone_no,  fax_no, extension_no, class_sales, class_data_input, update_date)
		values(#{ORGANIZATION_CD},#{COMPANY_CD},#{COMPANY_NM},#{CONTROL_CD},
		#{CONTROL_NM},#{CHARGE_CD},#{CHARGE_NM},#{PARENT_DEPARTMENT_CD},
		#{PARENT_DEPARTMENT_NM},#{DEPARTMENT_CD},#{DEPARTMENT_NM},
		#{DEPARTMENT_NM_EN},#{ZIP_CD},#{ADDRESS},#{TELEPHONE_NO},
		#{FAX_NO},#{EXTENSION_NO},#{CLASS_SALES},#{CLASS_DATA_INPUT},to_timestamp(#{UPDATE_DATE},'YYYYMMDDHH24MISS')::timestamp without time zone)
	</insert>

<insert id="insertBizEmployee" parameterType="Map">
    insert into
    tmp_integratedid_employee(organization_cd,company_cd,department_cd,department_nm,employee_cd,employee_nm_kanji,employee_nm_kana,executive_post_cd,post_lineage_cd,class,sex_cd,birthday,mail_address,assign_grade,class_tel_addressbook,class_temporary_transfer,mail_address_automade_flg,class_data_input,update_date)
    values(#{ORGANIZATION_CD},#{COMPANY_CD},#{DEPARTMENT_CD},#{DEPARTMENT_NM},
    #{EMPLOYEE_CD},#{EMPLOYEE_NM_KANJI},#{EMPLOYEE_NM_KANA},#{EXECUTIVE_POST_CD},
    #{POST_LINEAGE_CD},#{CLASS},#{SEX_CD},#{BIRTHDAY},#{MAIL_ADDRESS},#{ASSIGN_GRADE},
    #{CLASS_TEL_ADDRESSBOOK},#{CLASS_TEMPORARY_TRANSFER},#{MAIL_ADDRESS_AUTOMADE_FLG},#{CLASS_DATA_INPUT}, to_timestamp(#{UPDATE_DATE},'YYYYMMDDHH24MISS')::timestamp without time zone)
</insert>

	<insert id="insertBizOrganization" parameterType="Map">
		insert into
		tmp_integratedid_organization(organization_cd, organization_nm, organization_no, organization_abbreviated_nm, print_order, class_sales, class_data_input, update_date)
		values(#{ORGANIZATION_CD},#{ORGANIZATION_NM},#{ORGANIZATION_NO},
		#{ORGANIZATION_ABBREVIATED_NM},#{PRINT_ORDER},#{CLASS_SALES},#{CLASS_DATA_INPUT},to_timestamp(#{UPDATE_DATE},'YYYYMMDDHH24MISS')::timestamp without time zone)
	</insert>

	<!-- å–è¾¼å‰å‰Šé™¤ -->
	<delete id="deleteBizAD" parameterType="Map">
		delete from tmp_ad;
	</delete>
	<delete id="deleteBizDepartment" parameterType="Map">
		delete from
		tmp_integratedid_department;
	</delete>
	<delete id="deleteBizEmployee" parameterType="Map">
		delete from
		tmp_integratedid_employee;
	</delete>
	<delete id="deleteBizOrganization" parameterType="Map">
		delete from
		tmp_integratedid_organization;
	</delete>

	<!-- DUM ãƒ†ãƒ¼ãƒ–ãƒ«é™¤å¤–ç³» -->
	<delete id="deleteDumOrganization" parameterType="Map">
		delete
		from tmp_integratedid_organization
		where organization_cd in
		(select organization_cd
		from tmp_organization)
	</delete>

	<delete id="deleteDumDepartment" parameterType="Map">
		delete from
		tmp_integratedid_department
		where (company_cd, department_cd)
		in (select company_cd,
		department_cd
		from tmp_department);
		delete from tmp_integratedid_department
		where
		company_cd not in ('001', '002');
	</delete>

	<delete id="deleteDumEmployee" parameterType="Map">
		delete from
		tmp_integratedid_employee
		where (company_cd, employee_cd, assign_grade)
		in (select company_cd,
		employee_cd,
		assign_grade
		from tmp_employee);
		delete from tmp_integratedid_employee
		where company_cd
		not in ('001', '002');
		delete from tmp_integratedid_employee
		where
		executive_post_cd
		in (select executive_post_cd
		from tmp_executive);
	</delete>

	<!-- M_Sectionè¿½åŠ æ›´æ–° -->
	<select id="selNotExistMSection" resultType="Map">
		select
		  company_cd,
		  department_cd
		from
		  tmp_integratedid_department
		where
		  (company_cd, department_cd) not in (
		     select
		       company_cd,
		       lpad(section_cd,5,'0')
		     from
		       mst_section
		  )
	</select>

	<select id="selExistMSection" resultType="Map">
		select
		company_cd,
		department_cd
		from
		tmp_integratedid_department
		where
		(company_cd, department_cd) in (
		select
		company_cd,
		lpad(section_cd,5,'0')
		from
		mst_section
		)
	</select>

	<select id="selDiffMSection" resultType="Map">
		select * from
		(select
		D.department_nm as deptnm,
		lpad(D.parent_department_cd, 5, '0') as pdeptid,
		D.organization_cd as orgcd,
		O.print_order as depprord
		from tmp_integratedid_department as D inner join tmp_integratedid_organization as O
		on D.organization_cd = O.organization_cd
		where D.company_cd = #{companyCode}
		and D.department_cd = #{departmentCode} ) as dep
		inner join
		(select
		section_nm as secnm,
		lpad(parent_section_cd, 5, '0') as psecid,
		organization_cd as orgid,
		print_order as secprord
		from mst_section
		where company_cd = #{companyCode}
		and lpad(section_cd,5,'0') = #{departmentCode}) as msec
		on dep.deptnm != msec.secnm
		or dep.pdeptid != msec.psecid
		or dep.orgcd != msec.orgid
		or dep.depprord != msec.secprord
	</select>

	<update id="updateMSection" parameterType="Map">
		update mst_section set
		section_nm = #{department_nm},
		parent_section_cd = #{parent_department_cd},
		organization_cd= #{organization_cd},
		print_order = #{print_order},
		update_date = now()
		where company_cd = #{companyCode}
		and lpad(section_cd,5,'0') = #{departmentCode}
	</update>

	<insert id="selinsMSection" parameterType="Map">
		<selectKey keyProperty="mstNextId" resultType="int" order="BEFORE">
			select nextval('mst_section_section_id_seq')
		</selectKey>
		insert into mst_section
		select
		#{mstNextId} as section_id,
		D.company_cd as company_cd,
		lpad(D.department_cd,5,'0') as section_cd,
		D.department_nm as section_nm,
		lpad(D.parent_department_cd,5,'0') as parent_section_cd,
		D.organization_cd as organization_cd,
		O.print_order,
		now(),
		now()
		from tmp_integratedid_department as D inner join tmp_integratedid_organization as O
		on
		D.organization_cd = O.organization_cd
		where D.company_cd = #{companyCode}
		and D.department_cd  = #{departmentCode}
	</insert>

<!-- APP_User è¿½åŠ æ›´æ–°å‰Šé™¤ -->
	<select id="selRetireUsers" resultType="Map">
		select distinct
		user_id
		from trn_user
		where biz_employee_id not in
		(select
		employee_cd
		from tmp_integratedid_employee)
		and trn_user.enabled_shared_use != '1'
	</select>

	<update id="updDelEmpAppUser" parameterType="Map">
		update rel_user_section set
		delete_reserve= '1',
		update_date = now()
		where user_id = #{user_id}
	</update>

	<update id="updDelEmpRUserSection" parameterType="Map">
		update
		r_user_section set
		deleted = '1',
		lastupdate_datetime = now()
		where app_user_id = #{user_id}
	</update>

	<update id="updDelEmpRUserPhone" parameterType="Map">
		update
		rel_cucm_user_phone set
		delete_flg = '1',
		update_date = now()
		where user_id = #{user_id}
	</update>

	<update id="updDelEmpTelDir" parameterType="Map">
		update
		tel_dir_association set
		deleted = '1',
		lastupdate_datetime = now()
		where app_user_id = #{appUserId}
	</update>

	<!-- å‰Šé™¤å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ã®é›»è©±æ©Ÿå–å¾— -->
	<select id="delUserToPhone" parameterType="Map" resultType="Map">
		select usr.user_id as userid,
		phone.phone_id as phoneid
		from trn_user usr inner join rel_cucm_user_phone rpu
		on usr.user_id = rpu.user_id
		inner join trn_phone phone
		on rpu.phone_id = phone.phone_id
		where usr.user_id =
		#{user_id}
	</select>
	<!-- é›»è©±æ©Ÿã®æ–°ã‚ªãƒ¼ãƒŠãƒ¼å–å¾— -->
	<select id="delUserNewOwnerPhone" parameterType="Map"
		resultType="Map">
		select usr.cucm_login_id
		from trn_user usr inner join rel_cucm_user_phone rpu
		on usr.user_id = rpu.user_id
		inner join trn_phone phone
		on rpu.phone_id = phone.phone_id
		where usr.user_id = #{user_id}
		order by usr.user_id ASC
		limit 1
	</select>
	<!-- æ–°é›»è©±æ©Ÿã‚ªãƒ¼ãƒŠãƒ¼æ›´æ–° -->
	<update id="updDelEmpPhoneOwner" parameterType="Map">
		update trn_phone
		set
		owner_user_id = #{newOwner},
		delete_flg = '1',
		update_status= '1',
		update_date = now()
		where phone_id = #{phoneId}
	</update>


	<!-- ç¤¾å“¡è¿½åŠ  -->
	<select id="selAdditionUsers" resultType="Map">
		select distinct
		employee_cd
		from tmp_integratedid_employee
		where employee_cd not in
		(select
		biz_employee_id
		from trn_user)
	</select>

<select id="selAdditionUserDetail" resultType="Map">
select
    '0' as user_role,
    '0' as enabled_shared_use,
    case
        when tmp_ad.position = '_ç¤¾å“¡' then '1'
        when tmp_ad.position = '_æ´¾é£ç¤¾å“¡' then '0'
    end as fulltime_employee,
    case
        when tmp_ad.POSITION = '_ç¤¾å“¡' THEN tmp_integratedid_employee.birthday
        when tmp_ad.POSITION = '_æ´¾é£ç¤¾å“¡' THEN CONCAT('0', tmp_integratedid_employee.employee_cd)
    end as login_password,
    tmp_integratedid_employee.employee_cd AS login_id,
    tmp_integratedid_employee.employee_cd AS biz_employee_id,
    tmp_integratedid_employee.employee_cd AS cucm_login_id,
    tmp_integratedid_employee.employee_nm_kanji,
    tmp_integratedid_employee.employee_nm_kana,
    tmp_integratedid_employee.birthday,
    COALESCE(tmp_ad.first_nm, tmp_integratedid_employee.employee_cd) AS first_name,
    COALESCE(tmp_ad.last_nm, tmp_integratedid_employee.employee_cd) AS last_name,
    tmp_integratedid_employee.department_nm
from
    tmp_integratedid_employee
    left outer join
        tmp_ad
    ON  tmp_integratedid_employee.employee_cd = tmp_ad.login_nm
where
    employee_cd = (
        select distinct
            employee_cd
        from
            tmp_integratedid_employee
        where
            employee_cd =#{employee_cd}
    )
limit 1
</select>

<insert id="insAdditionUserDetail" parameterType="Map">
INSERT INTO trn_user (
    user_role,
    enabled_shared_use,
    fulltime_employee,
    cucm_login_pw,
    login_id,
    login_pw,
    biz_employee_id,
    cucm_login_id,
    user_nm_kanji,
    user_nm_kana,
    birthday,
    department,
    first_nm,
    last_nm,
    pin,
    enable_cti_application_use,
    last_pw_update,
    authenticate_failure_num,
    account_lock,
    create_date,
    update_date
  )
  SELECT
    '0' as user_role,
    '0' as enabled_shared_use,
    CASE WHEN tmp_ad.position = '_ç¤¾å“¡' THEN '1' WHEN tmp_ad.position = '_æ´¾é£ç¤¾å“¡' THEN '0' END as fulltime_employee,
    CASE WHEN tmp_ad.position = '_ç¤¾å“¡' THEN tmp_integratedid_employee.birthday WHEN tmp_ad.position = '_æ´¾é£ç¤¾å“¡' THEN CONCAT('0', tmp_integratedid_employee.employee_cd) END as cucm_login_pw,
    tmp_integratedid_employee.employee_cd as login_id,
    '' as login_pw,
    tmp_integratedid_employee.employee_cd as biz_employee_id,
    tmp_integratedid_employee.employee_cd as cucm_login_id,
    tmp_integratedid_employee.employee_nm_kanji,
    tmp_integratedid_employee.employee_nm_kana,
    tmp_integratedid_employee.birthday,
    tmp_integratedid_employee.department_nm as department,
    COALESCE(tmp_ad.first_nm, tmp_integratedid_employee.employee_cd) as first_nm,
    COALESCE(tmp_ad.last_nm, tmp_integratedid_employee.employee_cd) as last_nm,
    '12345' as pin,
    '1' as enable_cti_application_use,
    now() as last_pw_update,
    0 as authenticate_failure_num,
    '×¡' as account_lock,
    now() as create_date,
    now() as update_date
  FROM
    tmp_integratedid_employee
  LEFT OUTER JOIN tmp_ad ON tmp_integratedid_employee.employee_cd = tmp_ad.login_nm
  WHERE
    tmp_integratedid_employee.employee_cd = #{employee_cd}

</insert>

<!-- ç¤¾å“¡ æ›´æ–° -->
<select id="selExistAppUser" resultType="Map">
select distinct
    employee_cd
from
    tmp_integratedid_employee
where
    employee_cd in(
        select
            biz_employee_id
        from
            trn_user
    )
</select>

<select id="selDiffAppUser" resultType="Map">
select
    *
from
    (
        select distinct
            fulltime_employee as apfullemp,
            user_nm_kanji as apkanji,
            user_nm_kana as apkana,
            birthday as apbirth,
            first_nm as apfirstnm,
            last_nm as aplastnm,
            department
        from
            trn_user
        where
            biz_employee_id = #{employeeCode}
    ) app
    inner join
        (
            select distinct
                case
                    when ad.position = '_ç¤¾å“¡' then '1'
                    when ad.position = '_æ´¾é£ç¤¾å“¡' then '0'
                end as bzfullemp,
                emp.employee_nm_kanji as bzkanji,
                emp.employee_nm_kana as bzkana,
                emp.birthday as bzbirth,
                coalesce(ad.first_nm, emp.employee_cd) as bzfirstnm,
                coalesce(ad.last_nm, emp.employee_cd) as bzlastnm,
                department_nm as bzdepartment
            from
                tmp_integratedid_employee emp
                left outer join
                    tmp_ad ad
                on  emp.employee_cd = ad.login_nm
            where
                emp.employee_cd = (
                    select distinct
                        employee_cd
                    from
                        tmp_integratedid_employee
                    where
                        employee_cd = #{employeeCode}
                )
        ) biz
    on  app.apfullemp != biz.bzfullemp
    or  app.apkanji != biz.bzkanji
    or  app.apkana != biz.bzkana
    or  app.apbirth != biz.bzbirth
    or  app.apfirstnm != biz.bzfirstnm
    or  app.aplastnm != biz.bzlastnm
    or  app.department != biz.bzdepartment
</select>

<update id="updateAppUser" parameterType="Map">
update
    trn_user
set
    fulltime_employee = #{fulltime_employee},
    user_nm_kanji = #{user_nm_kanji},
    user_nm_kana = #{user_nm_kana},
    birthday = #{birthday},
    first_nm = #{first_nm},
    last_nm = #{last_nm},
    department = #{department},
    lastupdate_datetime = now()
where
    biz_employee_id = #{employeeCode}
</update>

<update id="updateTrnPhone" parameterType="Map">
UPDATE trn_phone
SET update_status = '1', update_date = NOW()
WHERE trn_phone.phone_id IN (
  SELECT rel_cucm_user_phone.phone_id
  FROM rel_cucm_user_phone
  INNER JOIN trn_user ON trn_user.user_id = rel_cucm_user_phone.user_id
  WHERE trn_user.biz_employee_id = #{employeeCode}
);
</update>

	<!-- USER_SECTION è¿½åŠ  20230708-->
	<select id="selAdditionUserSection" resultType="Map">
		select distinct
		be.company_cd,
		be.department_cd,
		be.employee_cd
		from tmp_integratedid_employee be inner join trn_user AU on (be.employee_cd =
		AU.biz_employee_id)
		where lpad(be.department_cd, 5, '0') not in
		( select lpad(cast(section_id as text), 5, '0')
		from rel_user_section, trn_user
		where trn_user.user_id = rel_user_section.user_id
		)
		order by 1,2,3
	</select>

<select id="selExistDepartment" resultType="Map">
		select
		company_cd,
		section_cd
		from mst_section
		where
		company_cd = #{companyCode}
		and lpad(section_cd,5,'0') = #{departmentCode}
	</select>

	<select id="selExistUserSection" resultType="int">
select count(1) from
    (select A.user_id as user_id,
        E.company_cd as company_cd,
        lpad(E.department_cd,5,'0') as section_id
    from tmp_integratedid_employee E inner join trn_user A on E.employee_cd = A.biz_employee_id
    inner join tmp_integratedid_organization O on E.organization_cd = O.Organization_cd
    where
        E.company_cd = #{companyCode}
    and E.employee_cd = #{employeeCode}) as emp
inner join
    (select user_id, section_id  from rel_user_section) as sec
on (emp.user_id = sec.user_id
and emp.section_id = lpad(cast(sec.section_id as text), 5, '0'));
	</select>

	<select id="selAdditionUserSectionDetail" resultType="Map">
SELECT
    A.user_id,
    E.company_cd,
    LPAD(E.department_cd, 5, '0') AS department_cd,
    E.department_nm,
    O.print_order
FROM
    tmp_integratedid_employee E
    INNER JOIN mst_section M ON E.department_cd = M.section_cd
    INNER JOIN trn_user A ON E.employee_cd = A.biz_employee_id
    INNER JOIN rel_user_section R ON A.user_id = R.user_id
    INNER JOIN tmp_integratedid_organization O ON E.organization_cd = O.Organization_cd
WHERE
    E.company_cd = #{companyCode}
    AND LPAD(E.department_cd, 5, '0') = #{departmentCode}
    AND E.employee_cd = #{employeeCode}
	</select>

<insert id="insAdditionUserSection" parameterType="Map">
INSERT INTO rel_user_section (
    user_id,
    section_id,
    delete_reserve,
    create_date,
    update_date
)
SELECT
    A.user_id,
    CAST(LPAD(E.department_cd, 5, '0') AS INTEGER) AS section_id,
    'O' AS delete_reserve,
    NOW(),
    NOW()
FROM
    tmp_integratedid_employee E
    INNER JOIN trn_user A ON E.employee_cd = A.biz_employee_id
    INNER JOIN tmp_integratedid_organization O ON E.organization_cd = O.Organization_cd
WHERE
    E.company_cd = #{companyCode}
    AND LPAD(E.department_cd,5,'0') = #{departmentCode}
    AND E.employee_cd = #{employeeCode}
LIMIT 1;
</insert>


	<!-- USER_SECTION æ›´æ–° -->
	<select id="selExistDeptChk" resultType="Map">
select
  distinct be.company_cd,
  be.department_cd,
  be.employee_cd
from
  tmp_integratedid_employee be
  inner join mst_section M on be.company_cd = M.company_cd
  and be.department_cd = M.section_cd
  inner join rel_user_section R on lpad(be.department_cd, 5, '0') = lpad(
    cast(R.section_id as text),
    5,
    '0'
  )
  inner join trn_user AU on be.employee_cd = AU.biz_employee_id
	</select>

	<select id="selDiffUserSection" resultType="Map">
		select * from
			(select distinct
				E.department_nm as bizdeptnm,
				O.print_order as bizprintord
			from tmp_integratedid_employee E inner join tmp_integratedid_organization O
			on E.organization_cd = O.organization_cd
			where E.company_cd = #{companyCode}
			and E.department_cd = #{departmentCode}
			and E.employee_cd = #{employeeCode}
			) biz
		inner join
			(select distinct
				M.section_nm as appsectionnm,
				M.print_order as appprintord
			from mst_section M,
				trn_user T, rel_user_section R
			where R.user_id = T.user_id
			and R.section_id = M.section_id
			and cast(lpad(cast(R.section_id as text), 5, '0') AS VARCHaR)= #{departmentCode}
			and T.biz_employee_id =  #{employeeCode}
			) app
		on biz.bizdeptnm != app.appsectionnm
		limit 1
	</select>

	<!-- MST_åº—éƒ¨èª²ã€Œmst_sectionã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°ã™ã‚‹å‰ã«user_idã‚’å–å¾—ã™ã‚‹ -->
	<select id="selTrnUser" resultType="Map">
		select
		  user_id
		from
		  trn_user
		where
		biz_employee_id = #{employeeCode}
	</select>

		<!-- MST_åº—éƒ¨èª²ã€Œmst_sectionã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°ã™ã‚‹å‰ã«åº—éƒ¨èª²IDã‚’å–å¾—ã™ã‚‹ -->
	<select id="selMstSection" resultType="Map">
		select
		  M.section_id
		from
		  mst_section M INNER JOIN rel_user_section R
		  ON M.section_id = R.section_id
		where
		 M.company_cd = #{companyCode}
		 AND M.section_id = #{departmentCode}
		 AND R.user_id = #{user_id}
	</select>

	<update id="updateUserSection" parameterType="Map">
		update mst_section set
			section_nm = #{section_name},
			print_order = #{print_order},
			update_date = now()
		where section_id = #{section_id}
	</update>


	<!-- ç¤¾å“¡ã®è»¢å‡ºå…ƒæ‰€å±å‰Šé™¤ -->
	<select id="selChangePersonnel" resultType="Map">
		select distinct
		R.user_id,
		R.section_id,
		A.biz_employee_id
		from
		rel_user_section R inner join trn_user A
		on R.user_id = A.user_id
		where
		(cast(lpad(cast(R.section_id as text), 5, '0') AS VARCHAR),A.biz_employee_id)
		not in
		(select lpad(department_cd,5,'0'),employee_cd
		from tmp_integratedid_employee)
		and R.delete_reserve != '1'
		and A.fulltime_employee in ('0',
		'1')
	</select>

	<select id="selPersonnelUsedPhone" parameterType="Map"
		resultType="int">
SELECT COUNT(1)
FROM rel_cucm_user_phone
INNER JOIN trn_phone ON rel_cucm_user_phone.phone_id = trn_phone.phone_id
WHERE rel_cucm_user_phone.user_id = CAST(#{appUserId} AS INTEGER)
  AND LPAD(CAST(trn_phone.section_id AS TEXT), 5, '0') = LPAD(#{sectionId}, 5, '0')
  AND rel_cucm_user_phone.delete_flg != '1';

	</select>

	<delete id="deleteUserSection" parameterType="Map">
		delete from
		 rel_user_section
		where user_id = cast(#{appUserId} as integer)
		and lpad(cast(section_id as text), 5, '0') =
		lpad(#{sectionId},5,'0')
	</delete>

	<update id="updDelUserSection" parameterType="Map">
		update
		rel_user_section set
		delete_reserve = '1' ,
		update_date = now()
		where user_id = cast(#{appUserId} as integer)
		and
		and lpad(section_id,5,'0') =
		lpad(#{sectionId},5,'0')
	</update>


	<!-- æ‹ ç‚¹çµ±å»ƒåˆ -->
	<select id="selShiftOrganization" resultType="Map">
		select distinct
		old_branch_code,
		old_company_code,
		old_department_code,
		new_branch_code,
		new_company_code,
		new_department_code
		from biz_shift
	</select>

	<!-- å»ƒæ­¢æ‰€å±ç¤¾å“¡ -->
	<select id="selDelAffiliationUser" resultType="Map"
		parameterType="Map">
		select distinct
		U.app_user_id,
		U.biz_employee_id
		from app_user U inner join r_user_section R
		on U.app_user_id = R.app_user_id
		where R.company_id = #{companyId}
		and
		R.section_id = lpad(#{sectionId},5,'0')
		and U.deleted != '1'
		and
		R.deleted != '1'
	</select>

	<select id="selUserSectionCnt" resultType="int"
		parameterType="Map">
		select count(1)
		from biz_employee
		where employee_code =
		#{employeeCode}
		and company_code = #{companyId}
		and
		lpad(department_code,5,'0') = lpad(#{sectionId},5,'0')
	</select>

	<insert id="updChgPersonnelSection" parameterType="Map">
		insert into
		r_user_section
		select A.app_user_id,
		E.company_code as company_id,
		lpad(E.department_code,5,'0') as section_id,
		E.department_name as section_name,
		O.print_order,
		'0' as delete_reserve,
		'0' as deleted,
		now(),
		now()
		from biz_employee E inner join app_user A on E.employee_code =
		A.biz_employee_id
		inner join biz_organization O on E.organization_code = O.Organization_code
		where
		E.company_code = #{newCompanyCode}
		and lpad(E.department_code,5,'0') =
		lpad(#{newDepartmentCode},5,'0')
		and A.app_user_id = cast(#{appUserId}
		as integer)
		limit 1
	</insert>

	<update id="updChgPersonnelPhone" parameterType="Map">
		update
		r_cucm_user_phone
		set company_id = #{newCompanyCode},
		section_id = lpad(#{newDepartmentCode},5,'0'),
		lastupdate_datetime = now()
		where app_user_id = cast(#{appUserId} as integer)
		and
		company_id = #{oldCompanyCode}
		and lpad(section_id,5,'0') =
		lpad(#{oldDepartmentCode},5,'0')
	</update>

	<!-- å»ƒæ­¢æ‰€å±é›»è©±æ©Ÿ -->
	<select id="selDelAffiliationPhone" resultType="Map"
		parameterType="Map">
		select
		P.cucm_phone_id as phoneid,
		CP.name as cssnm,
		L.cucm_line_id as lineid,
		CL.name as pickupnm
		from
		cucm_phone P inner join r_cucm_phone_line R on P.cucm_phone_id = R.cucm_phone_id
		inner join cucm_line L on R.cucm_line_id = L.cucm_line_id
		inner join m_branch MB on P.branch_id = MB.branch_id
		inner join m_cluster MC on MB.cluster_id = MC.cluster_id
		left outer join calling_search_space CP on MC.cluster_id = CP.cluster_id
		and P.calling_search_space_name = CP.name
		left outer join pickup_group CL on MC.cluster_id = CL.cluster_id
		and L.call_pickup_group_name = CL.name
		where P.branch_id =
		#{oldBranchCode}
		and P.company_id = #{oldCompanyCode}
		and P.section_id =
		#{oldDepartmentCode}
	</select>

<select id="selNewCssNm" resultType="Map" parameterType="Map">
		select
		vorg.branch_id as branchid,
		vorg.parent_section_id as parentsection,
		SUBSTRING(name from '[_a-zA-Z]+$') as linekind
		from v_organization_level vorg,
		calling_search_space css, m_cluster mc, m_branch mb
		where css.name =
		#{oldCssNm}
		and vorg.branch_id = mb.branch_id
		and mb.cluster_id = mc.cluster_id
		and mc.cluster_id = css.cluster_id
		and vorg.branch_id = #{newBranchCode}
		and vorg.child_company_id = #{newCompanyCode}
		and vorg.child_section_id = #{newDepartmentCode}
	</select>

	<update id="updCssOrgPhone" parameterType="Map">
		update cucm_phone
		set
		calling_search_space_name = #{newCssNm},
		branch_id = #{newBranchCode},
		company_id = #{newCompanyCode},
		section_id = #{newDepartmentCode},
		cucm_update_request_flag = '2',
		lastupdate_datetime = now()
		where cucm_phone_id = #{phoneId}
	</update>

	<select id="selNewPickUpNm" resultType="Map" parameterType="Map">
		select new.name as newpickupnm
		from pickup_group org
		inner join
		pickup_group new
		on org.no = new.no
		inner join m_branch mb
		on
		mb.cluster_id = org.cluster_id
		and mb.branch_id = org.branch_id
		where
		org.name = #{oldPickUpNm}
		and new.branch_id = #{newBranchCode}
		and
		new.section_id = #{newDepartmentCode}
	</select>

	<update id="updPickUpLine" parameterType="Map">
		update cucm_line set
		call_pickup_group_name = #{newPickUpNm},
		fwd_all_css =#{newCssNm},
		fwd_busy_css =#{newCssNm},
		fwd_noans_css =#{newCssNm},
		cucm_update_request_flag = '2',
		lastupdate_datetime = now()
		where
		cucm_line_id = #{lineId}
	</update>

	<select id="selParentSectionId" resultType="Map"
		parameterType="Map">
		select parent_section_id
		from v_organization_level vorg
		where child_company_id = #{companyId}
		and child_section_id =
		#{sectionId}
	</select>

	<update id="updChgAssociation" parameterType="Map">
		update
		charge_association
		set branch_id = #{newBranchCode},
		company_id = #{newCompanyCode},
		parent_section_id = #{newParentSection},
		section_id = #{newDepartmentCode},
		lastupdate_datetime = now()
		where cucm_line_id = #{lineId}
		and branch_id = #{oldBranchCode}
		and company_id = #{oldCompanyCode}
		and parent_section_id =
		#{oldParentSection}
		and section_id = #{oldDepartmentCode}
	</update>

<!-- é€€ç¤¾è€…ãƒªã‚¹ãƒˆ -->
<select id="selAllRetireUserList" resultType="Map">
SELECT
    trn_user.last_nm,
    trn_user.first_nm,
    REPLACE(trn_user.telephone_no, '_', '') AS telephone_no,
    LOWER(trn_user.last_nm) || '_' || LOWER(trn_user.first_nm) AS full_name
FROM
    trn_user
    INNER JOIN rel_cucm_user_phone ON rel_cucm_user_phone.user_id = trn_user.user_id
    INNER JOIN rel_user_section ON rel_user_section.user_id = trn_user.user_id
WHERE
    rel_cucm_user_phone.delete_flg = '1'
    AND rel_user_section.delete_reserve = '1'
ORDER BY
    trn_user.telephone_no ASC;
</select>

<!-- æ–°å…¥è€…ãƒªã‚¹ãƒˆ -->
<select id="selAllAddUserList" resultType="Map" parameterType="String">
    select
    last_nm,
    first_nm,
    replace(telephone_no, '-', '') as telephone_no,
    lower(last_nm) || '_' || lower(first_nm) as full_name
    from trn_user
    where
    biz_employee_id = #{employeeId}
    order by telephone_no ASC;
</select>



</mapper>
```

# CUCM ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º/ãƒãƒƒãƒå‡¦ç†/batch ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources

`ãƒãƒƒãƒå‡¦ç†/batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources/environment.properties`

```properties
#######################################
# MasterParameter(TypeModel) \u53d6\u8fbc\u5bfe\u8c61Name ","\u533a\u5207\u308a\u3067\u5217\u6319
#######################################
typemodel.name=Cisco 6941,Cisco 7911,Cisco 7912,Cisco 7936,Cisco 7937,Cisco 7942,Cisco 7960,Cisco 7962,Cisco 9971

########################################
#FTP\u30c7\u30a3\u30ec\u30af\u30c8\u30ea
########################################
# Win32
InputDir.Win32=C:/files/importfiles/
#InputCompDir.Win32=C:/files/complatedfiles/
InputCompDir.Win32=C:/disk20/App/logmaint/logs
OutputDir.Win32=C:/var/www/download/data/export/batch/
OutputDir2.Win32=db/
OutputDir3.Win32=associate/
OutputDir4.Win32=circuitlist/
OutputRetireDir.Win32=C:/var/www/download/logs/batch
OutputNewUsersDir.Win32=C:/var/www/download/logs/nubatch
ReceiveDir.Win32=C:/tmpfiles

# Linux
InputDir.Linux=/home/batchuser/files/importfiles/
#InputCompDir.Linux=/home/batchuser/files/complatedfiles/
InputCompDir.Linux=/disk20/App/logmaint/logs
OutputDir.Linux=/var/www/download/data/export/batch/
OutputDir2.Linux=db/
OutputDir3.Linux=associate/
OutputDir4.Linux=circuitlist/
OutputRetireDir.Linux=/var/www/download/logs/batch/
OutputNewUsersDir.Linux=/var/www/download/logs/nubatch/
ReceiveDir.Linux=/var/www/tmpfiles
#######################################
#\u30ed\u30c3\u30af\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9
#######################################
# Win32
LockFile.Win32=/var/www/download/tmp/cucm.lock
# Linux
LockFile.Linux=/var/www/download/tmp/cucm_app_is_updating.lock
#######################################
#\u4eba\u4e8b\u60c5\u5831\u53d6\u308a\u8fbc\u307f
#######################################
BizOrganizationTableName=BIZ_ORGANIZATION
#BizDepartmentTableName=BIZ_DEPARTMENT
BizEmployeeTableName=BIZ_EMPLOYEE
BizAdTableName=BIZ_AD
BizShiftTableName=BIZ_SHIFT

TmpBizOrganizationTableName=TMP_INTEGRATEDID_ORGANIZATION
TmpBizDepartmentTableName=TMP_INTEGRATEDID_DEPARTMENT
TmpBizEmployeeTableName=TMP_INTEGRATEDID_EMPLOYEE
TmpBizAdTableName=TMP_AD

BizOrganizationCsvFileName=organization.csv
BizDepartmentCsvFileName=department.csv
BizEmployeeCsvFileName=employee.csv
BizAdCsvFileName=ad.csv
BizShiftCsvFileName=shift.csv

Eof.Ad=EOFAD
Eof.Am=EOFAM

TmpAdCsvFileName=ad.csv
TmpIntDepartmentCsvFileName=department.csv
TmpIntEmployeeCsvFileName=employee.csv
TmpIntOrganizationCsvFileName=organization.csv
RetiredUserFileName=retired_user.csv
JoinedUserFileName=joined_user.csv

DumOrganizationCsvFileName=dum_organization.csv
DumDepartmentCsvFileName=dum_department.csv
DumEmployeeCsvFileName=dum_employee.csv

RetiredUserFileName=retired_users.log
ErrorFile.Win32=C:/files/errfiles/
ErrorFile.Linux=/var/www/files/errfiles/
ErrorFileName=batcherr.log


#######################################
#\u4eba\u4e8b\u60c5\u5831\u53d6\u308a\u8fbc\u307f(CSV Header)
#######################################
BizAdCsvHeader=USER_LOGON_NAME,DISP_NAME,LAST_NAME,FIRST_NAME,MAIL,POSITION
BizDepartmentCsvHeader=ORGANIZATION_CODE,COMPANY_CODE,COMPANY_NAME,CONTROL_CODE,CONTROL_NAME,CHARGE_CODE,CHARGE_NAME,PARENT_DEPARTMENT_CODE,PARENT_DEPARTMENT_NAME,DEPARTMENT_CODE,DEPARTMENT_NAME,DEPARTMENT_NAME_ENGLISH,ZIP_CODE,ADDRESS,TELEPHONE_NUMBER,FAX_NUMBER,EXTENSION_NUMBER,CLASS_SALES,CLASS_DATA_INPUT,UPDATE_DATE
BizEmployeeCsvHeader=ORGANIZATION_CODE,COMPANY_CODE,DEPARTMENT_CODE,DEPARTMENT_NAME,EMPLOYEE_CODE,EMPLOYEE_NAME_KANJI,EMPLOYEE_NAME_KANA,EXECUTIVE_POST_CODE,POST_LINEAGE_CODE,CLASS,SEX_CODE,BIRTHDAY,MAIL_ADDRESS,ASSIGN_GRADE,CLASS_TEL_ADDRESSBOOK,CLASS_TEMPORARY_TRANSFER,MAIL_ADDRESS_AUTOMADE_FLAG,CLASS_DATA_INPUT,UPDATE_DATE
BizOrganizationCsvHeader=ORGANIZATION_CODE,ORGANIZATION_NAME,ORGANIZATION_NUMBER,ORGANIZATION_ABBREVIATED_NAME,PRINT_ORDER,CLASS_SALES,CLASS_DATA_INPUT,UPDATE_DATE
BizShiftCsvHeader=OLD_BRANCH_CODE,OLD_COMPANY_CODE,OLD_DEPARTMENT_CODE,NEW_BRANCH_CODE,NEW_COMPANY_CODE,NEW_DEPARTMENT_CODE

TmpBizAdCsvHeader=LOGIN_NM,DISP_NM,LAST_NM,FIRST_NM,MAIL,POSITION
TmpBizDepartmentCsvHeader=ORGANIZATION_CD,COMPANY_CD,COMPANY_NM,CONTROL_CD,CONTROL_NM,CHARGE_CD,CHARGE_NM,PARENT_DEPARTMENT_CD,PARENT_DEPARTMENT_NM,DEPARTMENT_CD,DEPARTMENT_NM,DEPARTMENT_NM_EN,ZIP_CD,ADDRESS,TELEPHONE_NO,FAX_NO,EXTENSION_NO,CLASS_SALES,CLASS_DATA_INPUT,UPDATE_DATE
TmpBizEmployeeCsvHeader=ORGANIZATION_CD,COMPANY_CD,DEPARTMENT_CD,DEPARTMENT_NM,EMPLOYEE_CD,EMPLOYEE_NM_KANJI,EMPLOYEE_NM_KANA,EXECUTIVE_POST_CD,POST_LINEAGE_CD,CLASS,SEX_CD,BIRTHDAY,MAIL_ADDRESS,ASSIGN_GRADE,CLASS_TEL_ADDRESSBOOK,CLASS_TEMPORARY_TRANSFER,MAIL_ADDRESS_AUTOMADE_FLG,CLASS_DATA_INPUT,UPDATE_DATE
TmpBizOrganizationCsvHeader=ORGANIZATION_CD, ORGANIZATION_NM, ORGANIZATION_NO, ORGANIZATION_ABBREVIATED_NM, PRINT_ORDER, CLASS_SALES, CLASS_DATA_INPUT, UPDATE_DATE


#######################################
#CSV EXPORT IMPORT NAME
#######################################
VoiceCsvHeader=DIRECTORY_NUMBER,LOGGER_DATA
ChargeCsvHeader=H,CCMGRP,department,division,telnum,6,7,8
CUCCsvHeader=last_name,first_name,directory_no,mail_address,'voicemail'
TelDirCsvHeader=biz_employee_id,section_id,external_phone_number,directory_number,call_pickup_group_no
ADCsvHeader=user_logon_name,disp_name,last_name,first_name,mail,position,directory_number
#LineListCsvHeader=statusname,directorynumber,dialinnumber,lineindex,kanjiusername,sectionusername,pickupgroupno,voicemailflg,busydestination,chargeassociationbranchid,chargeassociationparentsectionid,chargeassociationsectionid,chargeremarks,loggerdataname,teldirdata,teltypemodel,macaddress,phonebuttontemplete,branchtelname,sectiontelname,callingsearchspacename,orgaddonmodulename1,orgaddonmodulename2,orgringsettingname,tellineremarks,linetextlabel,noansdestination,externalphonenumbermask
LineListCsvHeader=status,directoryNo,dialin,externalPhoneNoMask,no,userNmKanji,userSectionNm,pickupGroupNm,busyDestination,noansDestination,chargeBranchCd,chargeParentSectionCd,chargeSectionCd,chargeRemarks,voiceLoggerNm,phoneClassNm,deviceTypeNm,macAddress,phoneTemplateNm,softkeyTemplateNm,phoneBranchNm,phoneSectionNm,callingSearchSpaceNm,addonModuleNm1,addonModuleNm2,addonModuleNm3,ringSettingNm,lineRemarks,lineTxtLabel,allDestination,phoneRemarks,voiceMailProfileNm,fomaNo,callingPartyTransformationMask,representativePickupNm,gwRepletionSpecialNo

VoiceTableName=VOICE_LOGGER_ASSOCIATION
CsvImport.Voice=VOICE.csv

CsvExport.Voice=EXPORT_VOICE.csv
CsvExport.CUC=EXPORT_CUC.csv
CsvExport.Charge=EXPORT_CHARGE.csv
CsvExport.TelDir=EXPORT_TELDIR.csv
CsvExport.AD=EXPORT_AD.csv
CsvExport.LineList=EXPORT_LINE_LIST.csv

#######################################
# ALL TABLE NAME \u5168TBL\u4e00\u62ecEXPIMP\u5bfe\u8c61
#######################################
AllTable=app_user,biz_ad,biz_department,biz_employee,biz_organization,biz_shift,c_cucm_line,c_cucm_phone,c_cucm_phone_line,calling_search_space,charge_association,unity_association,cucm_line,cucm_master_last_update,cucm_phone,devicepool,dum_department,dum_employee,dum_organization,exclude_executive,line_reflected_cluster,location,m_branch,m_cluster,m_enduser_config,m_enduser_config_access_group,m_line_config,m_phone_config,m_phone_vendor_config,m_section,phone_reflected_cluster,phone_template,pickup_group,r_cucm_phone_line,r_cucm_user_phone,r_section_branch,r_user_section,tel_dir_association,threshold,type_model,voice_logger_association


###########################################################################
# \u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u914d\u4fe1\u6a5f\u80fd\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3078\u306e\u63a5\u7d9a\u306e\u53ef\u5426\uff08\u30e1\u30fc\u30eb\u914d\u4fe1\u6a5f\u80fd\u3092\u8fc2\u56de\u3055\u305b\u308b\u304b\u5426\u304b\uff09
# \u203b\u203b\u203b \u30e1\u30fc\u30eb\u914d\u4fe1\u3092\u884c\u3046\u306a\u3089true \u203b\u203b\u203b
# (SMTP\u74b0\u5883\u306a\u3069\u306b\u4e0d\u90fd\u5408\u304c\u3042\u308c\u3070false)
# (2) ssl\u8a8d\u8a3c\u3059\u308b\u30b5\u30fc\u30d0\u30fc\u306a\u3089sslsend = true
###########################################################################
MailSender.enabled=false
MailSender.sslsend=false

###########################################################################
# Mail Sender (SMTP Client)
###########################################################################
MailSender.SenderName=CUCM\u9023\u643a\u30b7\u30b9\u30c6\u30e0
MailSender.MessageSubject=\u3010CUCM\u9023\u643a\u30b7\u30b9\u30c6\u30e0\u3011\u30a8\u30e9\u30fc\u5831\u544a
MailSender.SenderAddress=test-admin@irdb.co.jp

# \u30b7\u30a7\u30a2\u30c9\u30a2\u30c9\u30ec\u30b9\u306b\u306f\u5fc5\u305a\u9001\u4fe1\u3055\u308c\u307e\u3059
MailSender.SharedAddress=test-admin@irdb.co.jp
# Host\u540d\u306f \u30a2\u30c9\u30ec\u30b9\u540d\u307e\u305f\u306fIP\u30a2\u30c9\u30ec\u30b9
MailSender.HostSMTP=mail.irdb.jp
MailSender.HostSMTP.PORT=465
MailSender.HostSMTP.SSL=true
# Host\u540d\u306f \u30a2\u30c9\u30ec\u30b9\u540d\u307e\u305f\u306fIP\u30a2\u30c9\u30ec\u30b9
MailSender.HostPOP=mail.irdb.jp
MailSender.HostPOP.PORT=995

MailSender.Auth.ID=test-admin@irdb.co.jp
MailSender.Auth.Password=adminirdb

###########################################################################
# \u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u672c\u6587
###########################################################################

ErrorMailBody1=\
CallManager\u9023\u643a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3066\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\
\u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u8005\u306f\u30ed\u30b0\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\
\u5f53\u65e5\u5206\u306e\u30ed\u30b0\u306e\u6240\u5728\u306f\u3001\n\n\
\u3000\u3000(1) IP\u30a2\u30c9\u30ec\u30b9\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\uff1axxx.xx.xx.xxx\n\
\u3000\u3000(2) \u30a8\u30e9\u30fc\u30ed\u30b0\u683c\u7d0d\u5834\u6240\u3000\u3000\u3000\u3000\u3000\u3000\uff1a/var/www/download/logs/batch\n\
\u3000\u3000(3) \u539f\u56e0\u5206\u6790\u7528\u30c7\u30d0\u30c3\u30b0\u30ed\u30b0\u683c\u7d0d\u5834\u6240\uff1a/var/www/download/logs\n\n\
\u3068\u306a\u308a\u307e\u3059\u3002\n\
(\u524d\u65e5\u5206\u4ee5\u524d\u306e\u30ed\u30b0\u306b\u3064\u3044\u3066\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u65e5\u4ed8\u304c\u4ed8\u52a0\u3055\u308c\u3066\u3044\u307e\u3059)\n\
\u30ed\u30b0\u5185\u3067\u306e\u78ba\u8a8d\u7b87\u6240\u306f\u3001\u6b21\u306e\u65e5\u6642\u4ed8\u8fd1\u306b\u8a72\u5f53\u3059\u308b\u90e8\u5206\u3068\u306a\u308a\u307e\u3059\u3002\n\
\n\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u9001\u4fe1\u65e5\u6642\uff1a

ErrorMailBody2=\
\u30a8\u30e9\u30fc\u30ed\u30b0\u306b\u51fa\u529b\u3055\u308c\u305f\u6982\u8981\uff1a

###########################################################################
```

`ãƒãƒƒãƒå‡¦ç†/batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources/launch-context.xml`

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

	<!-- data access -->
	<import resource="dataAccess-context.xml" />

	<!-- JOBå®šç¾©ãƒ•ã‚¡ã‚¤ãƒ« -->
<!-- <import resource="classpath:/job/masterUpd.xml" /> -->
	<!-- <import resource="classpath:/job/consistencyInfo.xml" /> -->
	<!-- <import resource="classpath:/job/loadPersonnelInfo.xml" /> -->
	<import resource="classpath:/job/loadStaffInfo.xml" />
	<!-- <import resource="classpath:/job/allSubjectsReflect.xml" /> -->
	<import resource="classpath:/job/CSVExplmp.xml" />

	<!-- enable component scanning -->
	<context:component-scan base-package="jp.co.netmarks.service" />
	<context:component-scan base-package="jp.co.netmarks.util" />
	<context:component-scan base-package="jp.co.netmarks.batch.component" />
	<context:component-scan base-package="jp.co.netmarks.batch.dao" />

	<bean id="jobLauncher"
		class="org.springframework.batch.core.launch.support.SimpleJobLauncher">
		<property name="jobRepository" ref="jobRepository" />
	</bean>

	<bean id="mappedProcessor" class="jp.co.ksc.batch.step.processor.MappedProcessor" scope="step" />

	<bean id="simpleStep" class="org.springframework.batch.core.step.item.SimpleStepFactoryBean" abstract="true">
		<property name="transactionManager" ref="transactionManager" />
	</bean>

	<!-- ãƒ€ãƒŸãƒ¼è¨­å®š -->
	<bean id="jobRepository" class="org.springframework.batch.core.repository.support.MapJobRepositoryFactoryBean" p:transactionManager-ref="transactionManager" />
	<!--
		<bean id="dataSource" class="org.springframework.jdbc.datasource.SingleConnectionDataSource" />
		<bean id="transactionManager" class="org.springframework.batch.support.transaction.ResourcelessTransactionManager"  />
	 -->

	<!-- properties -->
	<bean id="properties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
	   <property name="locations">
	       <list>
	           <value>classpath:environment.properties</value>
	           <value>classpath:message.properties</value>
	       </list>
	   </property>
	</bean>
</beans>
```

`ãƒãƒƒãƒå‡¦ç†/batchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/irdb/resources/dataAccess-context.xml`

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="org.postgresql.Driver" />
        <property name="url" value="jdbc:postgresql://localhost:5432/irdb utf8" />
        <property name="username" value="root" />
        <property name="password" value="" />
    </bean>

    <!-- transaction manager, use JtaTransactionManager for global tx -->
    <bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource" />
    </bean>

    <!-- define the SqlSessionFactory -->
    <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="typeAliasesPackage" value="jp.co.ksc.batch.model, jp.co.netmarks.batch.model, jp.co.ksc.model, jp.co.netmarks.model" />
    </bean>

    <!-- scan for mappers and let them be autowired -->
    <bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">
        <property name="basePackage" value="jp.co.netmarks.batch.persistence, jp.co.netmarks.persistence" />
    </bean>

</beans>
```
